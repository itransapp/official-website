import{l as e,R as N,P as w,Q as k,L as y,r as c,S as $,z as f}from"./index-CydsovlJ.js";import{O as _}from"./Open-DOBujlW1.js";import{A as S,o as A}from"./Avatar-By7doc61.js";import{c as C,a as p}from"./date-B07L3PBN.js";import{l as h}from"./chunk-MPX6TMFQ-DFe2x2y7.js";import{$ as L}from"./import-B1vComcX.js";import{d as b,a as g,b as j,m as v}from"./chunk-L6QJ42W6-C3E9DDUy.js";import{i as M}from"./chunk-TC4QW7OA-rXGJNrBp.js";import"./index-k1QGnjXa.js";import"./chunk-LSZJW3GU-B9locpnz.js";import"./chunk-CAFRINWI-CcU5yOMx.js";import"./index-B3r9EpSZ.js";import"./index-CsT4kJ4e.js";import"./import-Dr7D0HA9.js";import"./Combination-tZfAuD77.js";import"./chunk-3YBC73XM-aAikSDuu.js";import"./chunk-M3MASYO7-CXOgLzGh.js";import"./import-D4sfX339.js";import"./chunk-44JHHBS2-DoPaCBc5.js";var T=L,Z=T;const F=s=>e.jsxs("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 0 24 24",width:"1em",color:"#a371f7",className:"inline-block overflow-visible align-text-bottom fill-current",...s,children:[e.jsx("path",{d:"M11.28 6.78a.75.75 0 0 0-1.06-1.06L7.25 8.69 5.78 7.22a.75.75 0 0 0-1.06 1.06l2 2a.75.75 0 0 0 1.06 0l3.5-3.5Z"}),e.jsx("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0Zm-1.5 0a6.5 6.5 0 1 0-13 0 6.5 6.5 0 0 0 13 0Z"})]}),B=s=>e.jsx("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 -960 960 960",width:"1em",className:"inline-block overflow-visible align-text-bottom fill-current",...s,children:e.jsx("path",{d:"M240-400h480v-80H240v80Zm0-120h480v-80H240v80Zm0-120h480v-80H240v80ZM880-80 720-240H160q-33 0-56.5-23.5T80-320v-480q0-33 23.5-56.5T160-880h640q33 0 56.5 23.5T880-800v720ZM160-320h594l46 45v-525H160v480Zm0 0v-480 480Z"})}),E=s=>{if(s.length!==6&&s.length!==7)return;const r=parseInt(s.charAt(0)==="#"?s.slice(1,7):s,16);return{R:r>>16&255,G:r>>8&255,B:r&255}},H=s=>{const r=s.R/255,t=s.G/255,a=s.B/255,o=Math.min(r,t,a),n=Math.max(r,t,a),l=n-o;let m=0,u=0;const i=(n+o)/2;return l!==0&&(u=l/(i<=.5?n+o:2-n-o),r===n?m=(t-a)/l+(t<a?6:0):t===n?m=(a-r)/l+2:m=(r-t)/l+4,m*=60),{H:m,S:u*100,L:Math.round(i*100)}},R=({size:s,mode:r,color:t,name:a,style:o})=>{const n=E(t);if(!n)return null;const l=H(n);return e.jsx(C,{size:s,className:`${r==="light"?"label-light":"label-dark"}`,style:{"--label-r":n.R,"--label-g":n.G,"--label-b":n.B,"--label-h":l.H,"--label-s":l.S,"--label-l":l.L,marginRight:"0.250rem",...o},classNames:{content:"font-medium"},children:a})},z=({size:s,mode:r,labels:t})=>t.map((a,o)=>e.jsx(R,{mode:r,size:s,...a},o)),O=({mode:s,entry:r})=>e.jsxs("div",{className:"flex flex-auto items-center hover:bg-gray-100 dark:hover:bg-gray-800 rounded-none sm:rounded-lg",children:[e.jsx("div",{className:"flex-shrink-0 pt-2 pl-3",children:r.close?e.jsx(F,{height:"2em",width:"2em"}):e.jsx(_,{height:"2em",width:"2em"})}),e.jsxs("div",{className:"min-w-0 p-2 pr-3 md:pr-2",children:[e.jsx(h,{className:"text-large font-medium",color:"foreground",underline:"hover",style:{userSelect:"text"},href:`/chalkboard/${r.id.toString()}`,children:r.title}),e.jsx("div",{className:"ml-2 inline",children:r.labels?e.jsx(z,{size:"sm",mode:s,labels:r.labels}):e.jsx(e.Fragment,{})}),e.jsxs("div",{className:"text-gray-400",style:{fontSize:"13px"},children:[`#${r.id.toString(16).slice(0,8)} `,r.close?e.jsxs(e.Fragment,{children:[e.jsx(h,{size:"sm",href:`/user/${r.username}`,children:`@${r.username}`}),e.jsx("p",{className:"inline ml-1",children:`was closed ${p(r.updatedAt)} ago`})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"inline",children:`opened ${p(r.createdAt)} ago by`}),e.jsx(h,{className:"ml-1",size:"sm",href:`/user/${r.username}`,children:`@${r.username}`})]})]})]}),e.jsxs("div",{className:"hidden sm:flex ml-auto flex-shrink-0 items-center justify-between text-right pr-3 whitespace-nowrap ",children:[e.jsx("span",{className:"ml-2 flex-1 flex-shrink-0",children:e.jsx(S,{alt:r.username,size:"sm",src:`@${r.username}`})}),e.jsxs("span",{className:"ml-6 flex-1 flex-shrink-0 items-center content-center text-gray-700 dark:text-gray-300",children:[e.jsx(B,{width:"1rem",height:"1rem",className:"inline-flex overflow-visible fill-current"}),e.jsx("span",{className:"ml-1 text-small font-bold",children:r.comments})]})]})]}),G=({entries:s})=>{const[r]=N(w);return e.jsx("div",{className:"w-full divide-y divide-gray-200 dark:divide-gray-700",children:s.map((t,a)=>e.jsx(O,{mode:r,entry:t},a))})},q=s=>e.jsx("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 -960 960 960",width:"1em",className:"inline-block overflow-visible align-text-bottom fill-current",...s,children:e.jsx("path",{d:"M480-360 280-560h400L480-360Z"})}),Q=({color:s,width:r,height:t})=>e.jsx("span",{className:"flex-shrink-0 inline-block rounded-lg",style:{width:r,height:t,backgroundColor:s}}),x={is:{open:()=>({open:!0})},author:{"@me":()=>({author:"self"}),"*":s=>s.charAt(0)==="@"?{author:s.slice(1,s.length)}:{author:s}},mentions:{"@me":()=>({mentions:"self"}),"*":s=>s.charAt(0)==="@"?{mentions:s.slice(1,s.length)}:{mentions:s}},label:{"*":s=>({label:[s.slice(1,s.length-1)]})}},D=s=>{const r={};return s.split(" ").reduce((t,a)=>{const[o,n]=a.split(":");if(o&&n){const l=o.trim(),m=n.trim();t[l]||(t[l]=new Set),t[l].has(l)||t[l].add(m)}return t},r),Object.fromEntries(Object.entries(r).map(([t,a])=>[t,[...a]]))},V=s=>{const r=[],t=D(s);for(const[a,o]of Object.entries(t))x[a]&&o.forEach(n=>{(x[a][n]||x[a]["*"])&&r.push(`${a}:${n}`)});return r.join(" ")},I=[{name:"Open chalkboards",rules:"is:open"},{name:"Your chalkboards",rules:"is:open author:@me"},{name:"Everything mentioning you",rules:"is:open mentions:@me"}],he=()=>{const{labels:s}=k(),{show:r}=y(),[t,a]=c.useState({total:0,offset:0,limit:10}),[o,n]=c.useState(void 0),[l,m]=c.useState("is:open"),[u]=A(l,1e3);return c.useEffect(()=>{l&&m(V(l))},[u]),c.useEffect(()=>{$({offset:t.offset,limit:t.limit,labels:[],sort:1}).then(i=>{var d;if(!i.data){r({message:"Failed to fetch chalkboards"});return}if(!i.data.status||!i.data.data){r({message:(d=i.data)==null?void 0:d.msg});return}a({...t,total:i.data.data.total}),console.log(i.data.data.list),n(i.data.data.list)}).catch(i=>{r({message:i.toString()})})},[t.limit,t.offset]),e.jsxs("div",{className:"sm:pl-2 sm:pr-2",children:[e.jsxs("div",{className:"pb-2 flex gap-2",children:[e.jsx(M,{classNames:{inputWrapper:"pl-0 h-unit-10 rounded-medium rounded-l-none sm:rounded-l-medium"},color:"primary",radius:"md",startContent:e.jsxs(b,{children:[e.jsx(g,{children:e.jsx(f,{endContent:e.jsx(q,{width:"1.25rem",height:"1.25rem"}),size:"md",className:"font-medium",variant:"light",children:"Filter"})}),e.jsx(j,{"aria-label":"chalkboard filter options",children:I.map((i,d)=>e.jsx(v,{onClick:()=>m(i.rules),children:i.name},d))})]}),value:l,onValueChange:m}),e.jsxs(b,{children:[e.jsx(g,{children:e.jsx(f,{className:"hidden md:flex font-medium",variant:"bordered",color:"secondary",children:"Labels"})}),e.jsx(j,{"aria-label":"label filter",selectionMode:"single",onAction:i=>{m(`${l} label:"${s[i].name}"`)},children:e.jsx(Z,{title:"Filter by label",children:s.map((i,d)=>e.jsx(v,{textValue:i.name,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Q,{color:i.color,width:"1rem",height:"1rem"}),e.jsx("div",{className:"ml-2 truncate min-w-0 flex items-center",children:e.jsx("div",{className:"font-medium",children:i.name})})]})},d))})})]}),e.jsx(f,{className:"hidden md:flex font-medium",color:"primary",as:h,href:"/chalkboard/new",children:"New Chalkboard"}),e.jsx(f,{className:"flex md:hidden rounded-r-none sm:rounded-r-medium font-medium",color:"primary",as:h,href:"/chalkboard/new",children:"New"})]}),e.jsx("div",{children:o?e.jsx(G,{entries:o}):e.jsx("div",{className:"py-3 flex items-center text-md text-gray-400 uppercase before:flex-1 before:border-t before:border-gray-200 before:me-6 after:flex-1 after:border-t after:border-gray-200 after:ms-6 dark:text-gray-500 dark:before:border-gray-600 dark:after:border-gray-600",children:"Empty"})})]})};export{he as default};
