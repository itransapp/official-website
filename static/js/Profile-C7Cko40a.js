import{l as e,r as o,K as j,U as b,z as g,y as w,L as y,M as Z}from"./index-Dc3fXUUt.js";import{c as x,f as q,g as v}from"./date-BAivSS9M.js";import{i as p}from"./validator-CEpkGiwj.js";import{o as N}from"./index.module-CdMxw_0G.js";import{m as _,a as k,b as M,c as S,d as C}from"./chunk-II5OMS4Q--6Ttwqs3.js";import{i as U}from"./chunk-TC4QW7OA-B6KscaJD.js";import{d as P,a as E,b as B,m as T}from"./chunk-L6QJ42W6-DEriyZt4.js";import{a as D}from"./chunk-LSZJW3GU-udL2i9vI.js";import"./chunk-M3MASYO7-Dpbb6JsX.js";import"./import-BdcrFf2C.js";import"./Combination-eXL1s2XB.js";import"./chunk-CAFRINWI-CcU5yOMx.js";import"./import-D9cDQpha.js";import"./import-Cghifwir.js";import"./chunk-44JHHBS2-EE5cO59z.js";import"./index-Du8sGSuJ.js";import"./index-D0gXxBRc.js";import"./chunk-3YBC73XM-BtHS0Lt8.js";const H=r=>e.jsx("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 -960 960 960",width:"1em",className:"inline-block overflow-visible align-text-bottom fill-current",...r,children:e.jsx("path",{d:"M480-480q33 0 56.5-23.5T560-560q0-33-23.5-56.5T480-640q-33 0-56.5 23.5T400-560q0 33 23.5 56.5T480-480Zm0 294q122-112 181-203.5T720-552q0-109-69.5-178.5T480-800q-101 0-170.5 69.5T240-552q0 71 59 162.5T480-186Zm0 106Q319-217 239.5-334.5T160-552q0-150 96.5-239T480-880q127 0 223.5 89T800-552q0 100-79.5 217.5T480-80Zm0-480Z"})}),O=r=>e.jsx("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 -960 960 960",width:"1em",className:"inline-block overflow-visible align-text-bottom fill-current",...r,children:e.jsx("path",{d:"m80-80 200-560 360 360L80-80Zm132-132 282-100-182-182-100 282Zm370-246-42-42 224-224q32-32 77-32t77 32l24 24-42 42-24-24q-14-14-35-14t-35 14L582-458ZM422-618l-42-42 24-24q14-14 14-34t-14-34l-26-26 42-42 26 26q32 32 32 76t-32 76l-24 24Zm80 80-42-42 144-144q14-14 14-35t-14-35l-64-64 42-42 64 64q32 32 32 77t-32 77L502-538Zm160 160-42-42 64-64q32-32 77-32t77 32l64 64-42 42-64-64q-14-14-35-14t-35 14l-64 64ZM212-212Z"})}),L=r=>e.jsx("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 -960 960 960",width:"1em",className:"inline-block overflow-visible align-text-bottom fill-current",...r,children:e.jsx("path",{d:"M200-80q-33 0-56.5-23.5T120-160v-560q0-33 23.5-56.5T200-800h40v-80h80v80h320v-80h80v80h40q33 0 56.5 23.5T840-720v560q0 33-23.5 56.5T760-80H200Zm0-80h560v-400H200v400Zm0-480h560v-80H200v80Zm0 0v-80 80Zm280 240q-17 0-28.5-11.5T440-440q0-17 11.5-28.5T480-480q17 0 28.5 11.5T520-440q0 17-11.5 28.5T480-400Zm-160 0q-17 0-28.5-11.5T280-440q0-17 11.5-28.5T320-480q17 0 28.5 11.5T360-440q0 17-11.5 28.5T320-400Zm320 0q-17 0-28.5-11.5T600-440q0-17 11.5-28.5T640-480q17 0 28.5 11.5T680-440q0 17-11.5 28.5T640-400ZM480-240q-17 0-28.5-11.5T440-280q0-17 11.5-28.5T480-320q17 0 28.5 11.5T520-280q0 17-11.5 28.5T480-240Zm-160 0q-17 0-28.5-11.5T280-280q0-17 11.5-28.5T320-320q17 0 28.5 11.5T360-280q0 17-11.5 28.5T320-240Zm320 0q-17 0-28.5-11.5T600-280q0-17 11.5-28.5T640-320q17 0 28.5 11.5T680-280q0 17-11.5 28.5T640-240Z"})}),I=r=>{try{return BigInt(r)}catch{return}},R=({isOpen:r,onOpenChange:h,username:t,onUsernameChange:u})=>{const[n,d]=o.useState(t),[f,i]=o.useState(!1),[c]=N(n,1e3),{show:s}=j();return o.useEffect(()=>{if(c&&c!==t){if(!p(c)){i(!1);return}b({username:c,checkOnly:!0}).then(a=>{var l,m;if(!((l=a.data)!=null&&l.status)){i(!1),a.statusCode===200?s({message:"username already used"}):s({message:(m=a.data)==null?void 0:m.msg});return}i(!0)}).catch(a=>{s({message:a})})}else i(!1)},[c]),o.useEffect(()=>{d(t)},[t]),e.jsx(_,{isOpen:r,onOpenChange:a=>{d(t),h(a)},children:e.jsx(k,{children:a=>e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"flex flex-col gap-1",children:"Change your username"}),e.jsx(S,{children:e.jsx(U,{className:"font-medium",placeholder:"iTrans unique username",startContent:e.jsx("p",{className:"font-bold",children:"@"}),value:n,onValueChange:l=>{d(l)},errorMessage:p(n)?"":"invalid username"})}),e.jsxs(C,{children:[e.jsx(g,{color:"danger",variant:"light",onPress:a,children:"Cancel"}),e.jsx(g,{color:"primary",isDisabled:!f||n===t||!p(n),onPress:()=>{u(n),a()},children:"Submit"})]})]})})})},z=r=>e.jsx("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 -960 960 960",width:"1em",className:"inline-block overflow-visible align-text-bottom fill-current",...r,children:e.jsx("path",{d:"M480-260q75 0 127.5-52.5T660-440q0-75-52.5-127.5T480-620q-75 0-127.5 52.5T300-440q0 75 52.5 127.5T480-260Zm0-80q-42 0-71-29t-29-71q0-42 29-71t71-29q42 0 71 29t29 71q0 42-29 71t-71 29ZM160-120q-33 0-56.5-23.5T80-200v-480q0-33 23.5-56.5T160-760h126l74-80h240l74 80h126q33 0 56.5 23.5T880-680v480q0 33-23.5 56.5T800-120H160Zm0-80h640v-480H638l-73-80H395l-73 80H160v480Zm320-240Z"})}),A=r=>e.jsx("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 -960 960 960",width:"1em",className:"inline-block overflow-visible align-text-bottom fill-current",...r,children:e.jsx("path",{d:"M480-280q17 0 28.5-11.5T520-320q0-17-11.5-28.5T480-360q-17 0-28.5 11.5T440-320q0 17 11.5 28.5T480-280Zm-40-160h80v-240h-80v240ZM330-120 120-330v-300l210-210h300l210 210v300L630-120H330Zm34-80h232l164-164v-232L596-760H364L200-596v232l164 164Zm116-280Z"})}),oe=()=>{const[r,h]=o.useState({type:"self"}),[t,u]=o.useState({firstname:"",lastname:"System",createdAt:new Date}),[n,d]=o.useState({isOpen:!1,username:""}),{profile:f}=w(),{show:i}=j(),c=y();return o.useEffect(()=>{const s=c.id;if(!s)return;if(p(s)){h({type:"username",username:s});return}const a=I(s);if(a){h({type:"userID",userID:a});return}},[]),o.useEffect(()=>{switch(r.type){case"username":b({username:r.username}).then(s=>{var a,l,m;if(!((a=s.data)!=null&&a.data)||!((l=s.data)!=null&&l.status)){i({message:(m=s.data)==null?void 0:m.msg});return}u({...s.data.data})}).catch(s=>{i({message:s})});break;case"userID":i({message:"unsupported query method"});break;case"self":if(!f){i({message:"failed to get user profile"});return}u({...f});break}},[r]),e.jsxs("div",{children:[e.jsx(R,{isOpen:n.isOpen,onOpenChange:s=>{d({...n,isOpen:s})},username:t.username,onUsernameChange:s=>{d({...n,username:s}),s&&Z({username:s}).then(a=>{var l,m;if(!((l=a.data)!=null&&l.status)){i({message:(m=a.data)==null?void 0:m.msg});return}u({...t,username:s})}).catch(a=>{i({message:a})})}}),e.jsx("div",{style:{backgroundSize:"cover",backgroundImage:`url('${t.background?t.background:"/default-background.png"}')`,backgroundPosition:"center",backgroundRepeat:"no-repeat",height:"200px"},children:e.jsxs(P,{size:"sm",placement:"right-end",children:[e.jsx(E,{children:e.jsx(D,{style:{position:"relative",zIndex:10,top:"100%",left:"5%",transform:"translate(-5%, -50%)",width:"20vh",height:"auto",userSelect:"none"},alt:t.firstname,src:t.avatar||"/default-avatar.jpg",name:t.firstname,showFallback:!0})}),e.jsxs(B,{"aria-label":"avatar action",title:"Actions",children:[e.jsx(T,{startContent:e.jsx(z,{width:"1.25rem",height:"1.25rem"}),children:e.jsx("span",{className:"font-medium",children:"Upload photo"})},"select-new-photo"),r?e.jsx(T,{color:"danger",className:"text-danger",startContent:e.jsx(A,{width:"1.25rem",height:"1.25rem"}),children:e.jsx("span",{className:"font-medium",children:"Report this user"})},"report-this-user"):e.jsx(e.Fragment,{})]})]})}),e.jsx(g,{style:{position:"relative",zIndex:10,top:"100%",left:"95%",transform:"translate(-95%, 50%)"},color:"primary",variant:"bordered",radius:"lg",children:"Edit your profile"}),e.jsx("div",{className:"flex items-center mt-16 dark:bg-black",style:{marginTop:"10vh",width:"90%",transform:"translate(5%, 0%)"},children:e.jsxs("div",{children:[e.jsxs("p",{className:"text-4xl font-bold",children:[t.firstname," ",t.lastname,e.jsxs("span",{className:"ml-3 font-normal text-small text-gray-500 dark:text-gray-400 hover:underline",onClick:()=>d({...n,isOpen:!0}),children:["@",t.username||"SET YOUR USERNAME"]})]}),e.jsxs("p",{className:`${t.bio?"":"hidden"} font-medium`,children:["Bio:",e.jsx("span",{className:"ml-1 font-normal text-gray-600 dark:text-gray-300",children:t.bio})]}),e.jsxs("div",{className:"mt-5 whitespace-pre-wrap inline",children:[e.jsxs(x,{variant:"bordered",className:`${t.location?"mr-2":"hidden"}`,children:[e.jsx(H,{width:"1rem",height:"1rem"}),e.jsx("span",{className:"ml-1",children:t.location})]}),e.jsxs(x,{variant:"bordered",className:`${t.birthday?"mt-1 mr-2":"hidden"}`,children:[e.jsx(O,{width:"1rem",height:"1rem"}),e.jsxs("span",{className:"ml-1",children:["Born ",q(t.birthday,v("universal"))]})]}),e.jsxs(x,{variant:"bordered",className:"mt-1",children:[e.jsx(L,{width:"1rem",height:"1rem"}),e.jsxs("span",{className:"ml-1",children:["Joined ",q(t.createdAt,v("joinDay"))]})]})]})]})})]})};export{oe as default};
