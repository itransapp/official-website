import{l as e,P as w,L as N,r as c,Q as k,z as u}from"./index-CWvHVWpG.js";import{O as y,m as _}from"./Open-ClB1-79J.js";import{a as x,A as $}from"./Avatar-ChCZUKqf.js";import{L as A,C}from"./ColorDot-CyILEYsp.js";import{l as h}from"./chunk-MPX6TMFQ-BS7F1PpF.js";import{o as Z}from"./index.module-vU__u63E.js";import{d as p,b,c as j,m as g}from"./chunk-L6QJ42W6-Cch2fe3k.js";import{i as F}from"./chunk-TC4QW7OA-DFoL5MVH.js";import"./import--9aNNLJH.js";import"./index-C3t5u28Y.js";import"./index-QsUcXbWp.js";import"./chunk-OFH6WYRQ-Bc4py5Vv.js";import"./chunk-LY2CD73K-Dn7tJKMO.js";import"./chunk-CAFRINWI-CcU5yOMx.js";import"./Combination-CXI9X5xf.js";import"./chunk-44JHHBS2-DYrg1EOX.js";const L=r=>e.jsxs("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 0 24 24",width:"1em",color:"#a371f7",className:"inline-block overflow-visible align-text-bottom fill-current",...r,children:[e.jsx("path",{d:"M11.28 6.78a.75.75 0 0 0-1.06-1.06L7.25 8.69 5.78 7.22a.75.75 0 0 0-1.06 1.06l2 2a.75.75 0 0 0 1.06 0l3.5-3.5Z"}),e.jsx("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0Zm-1.5 0a6.5 6.5 0 1 0-13 0 6.5 6.5 0 0 0 13 0Z"})]}),S=r=>e.jsx("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 -960 960 960",width:"1em",className:"inline-block overflow-visible align-text-bottom fill-current",...r,children:e.jsx("path",{d:"M240-400h480v-80H240v80Zm0-120h480v-80H240v80Zm0-120h480v-80H240v80ZM880-80 720-240H160q-33 0-56.5-23.5T80-320v-480q0-33 23.5-56.5T160-880h640q33 0 56.5 23.5T880-800v720ZM160-320h594l46 45v-525H160v480Zm0 0v-480 480Z"})}),T=({entry:r})=>e.jsxs("div",{className:"flex flex-auto items-center hover:bg-gray-100 dark:hover:bg-gray-800 rounded-none sm:rounded-lg",children:[e.jsx("div",{className:"flex-shrink-0 pt-2 pl-3",children:r.close?e.jsx(L,{height:"2em",width:"2em"}):e.jsx(y,{height:"2em",width:"2em"})}),e.jsxs("div",{className:"min-w-0 p-2 pr-3 md:pr-2",children:[e.jsx(h,{className:"text-large font-medium",color:"foreground",underline:"hover",style:{userSelect:"text"},href:`/chalkboard/${r.id.toString()}`,children:r.title}),e.jsx("div",{className:"ml-2 inline",children:r.labels?e.jsx(A,{size:"sm",labels:r.labels}):e.jsx(e.Fragment,{})}),e.jsxs("div",{className:"text-gray-400",style:{fontSize:"13px"},children:[`#${r.id.toString(16).slice(0,8)} `,r.close?e.jsxs(e.Fragment,{children:[e.jsx(h,{size:"sm",href:`/user/${r.username}`,children:`@${r.username}`}),e.jsx("p",{className:"inline ml-1",children:`was closed ${x(r.updatedAt)} ago`})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"inline",children:`opened ${x(r.createdAt)} ago by`}),e.jsx(h,{className:"ml-1",size:"sm",href:`/user/${r.username}`,children:`@${r.username}`})]})]})]}),e.jsxs("div",{className:"hidden sm:flex ml-auto flex-shrink-0 items-center justify-between text-right pr-3 whitespace-nowrap ",children:[e.jsx("span",{className:"ml-2 flex-1 flex-shrink-0",children:e.jsx($,{alt:r.username,size:"sm",src:`@${r.username}`})}),e.jsxs("span",{className:"ml-6 flex-1 flex-shrink-0 items-center content-center text-gray-700 dark:text-gray-300",children:[e.jsx(S,{width:"1rem",height:"1rem",className:"inline-flex overflow-visible fill-current"}),e.jsx("span",{className:"ml-1 text-small font-bold",children:r.comments})]})]})]}),E=({entries:r})=>e.jsx("div",{className:"w-full divide-y divide-gray-200 dark:divide-gray-700",children:r.map((a,t)=>e.jsx(T,{entry:a},t))}),z=r=>e.jsx("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 -960 960 960",width:"1em",className:"inline-block overflow-visible align-text-bottom fill-current",...r,children:e.jsx("path",{d:"M480-360 280-560h400L480-360Z"})}),f={is:{open:()=>({open:!0})},author:{"@me":()=>({author:"self"}),"*":r=>r.charAt(0)==="@"?{author:r.slice(1,r.length)}:{author:r}},mentions:{"@me":()=>({mentions:"self"}),"*":r=>r.charAt(0)==="@"?{mentions:r.slice(1,r.length)}:{mentions:r}},label:{"*":r=>({label:[r.slice(1,r.length-1)]})}},M=r=>{const a={};return r.split(" ").reduce((t,l)=>{const[n,o]=l.split(":");if(n&&o){const i=n.trim(),m=o.trim();t[i]||(t[i]=new Set),t[i].has(i)||t[i].add(m)}return t},a),Object.fromEntries(Object.entries(a).map(([t,l])=>[t,[...l]]))},O=r=>{const a=[],t=M(r);for(const[l,n]of Object.entries(t))f[l]&&n.forEach(o=>{(f[l][o]||f[l]["*"])&&a.push(`${l}:${o}`)});return a.join(" ")},H=[{name:"Open chalkboards",rules:"is:open"},{name:"Your chalkboards",rules:"is:open author:@me"},{name:"Everything mentioning you",rules:"is:open mentions:@me"}],re=()=>{const{labels:r}=w(),{show:a}=N(),[t,l]=c.useState({total:0,offset:0,limit:10}),[n,o]=c.useState(void 0),[i,m]=c.useState("is:open"),[v]=Z(i,1e3);return c.useEffect(()=>{i&&m(O(i))},[v]),c.useEffect(()=>{k({offset:t.offset,limit:t.limit,labels:[],sort:1}).then(s=>{var d;if(!s.data){a({message:"Failed to fetch chalkboards"});return}if(!s.data.status||!s.data.data){a({message:(d=s.data)==null?void 0:d.msg});return}s.data.data.total!==0&&(l({...t,total:s.data.data.total}),o(s.data.data.list))}).catch(s=>{a({message:s.toString()})})},[t.limit,t.offset]),e.jsxs("div",{className:"sm:pl-2 sm:pr-2",children:[e.jsxs("div",{className:"pb-2 flex gap-2",children:[e.jsx(F,{classNames:{inputWrapper:"pl-0 h-unit-10 rounded-medium rounded-l-none sm:rounded-l-medium"},color:"primary",radius:"md",startContent:e.jsxs(p,{children:[e.jsx(b,{children:e.jsx(u,{endContent:e.jsx(z,{width:"1.25rem",height:"1.25rem"}),size:"md",className:"font-medium",variant:"light",children:"Filter"})}),e.jsx(j,{"aria-label":"chalkboard filter options",children:H.map((s,d)=>e.jsx(g,{onClick:()=>m(s.rules),children:s.name},d))})]}),value:i,onValueChange:m}),e.jsxs(p,{children:[e.jsx(b,{children:e.jsx(u,{className:"hidden md:flex font-medium",variant:"bordered",color:"secondary",children:"Labels"})}),e.jsx(j,{"aria-label":"label filter",selectionMode:"single",onAction:s=>{m(`${i} label:"${r[s].name}"`)},children:e.jsx(_,{title:"Filter by label",children:r.map((s,d)=>e.jsx(g,{textValue:s.name,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(C,{color:s.color,width:"1rem",height:"1rem"}),e.jsx("div",{className:"ml-2 truncate min-w-0 flex items-center",children:e.jsx("div",{className:"font-medium",children:s.name})})]})},d))})})]}),e.jsx(u,{className:"hidden md:flex font-medium",color:"primary",as:h,href:"/chalkboard/new",children:"New Chalkboard"}),e.jsx(u,{className:"flex md:hidden rounded-r-none sm:rounded-r-medium font-medium",color:"primary",as:h,href:"/chalkboard/new",children:"New"})]}),e.jsx("div",{children:n?e.jsx(E,{entries:n}):e.jsx("div",{className:"py-3 flex items-center text-md text-gray-400 uppercase before:flex-1 before:border-t before:border-gray-200 before:me-6 after:flex-1 after:border-t after:border-gray-200 after:ms-6 dark:text-gray-500 dark:before:border-gray-600 dark:after:border-gray-600",children:"Empty"})})]})};export{re as default};
