import{au as A,K as v,M as E,L as b,z as j,r as g,bd as y,aA as P,l as i,be as G}from"./index-CkAhvvvT.js";const V=()=>{const[s]=A(),a=v(),{show:r}=E(),{authed:p,update:h}=b(),x=j();return g.useEffect(()=>{if(p()){a("/");return}},[]),g.useEffect(()=>{const d=s.get("state"),o=s.get("code");if(!d||!o){r({message:"invalid params 'state', 'code'"}),setTimeout(()=>a("/login"),1500);return}y({state:d,code:o}).then(t=>{var n,u,c,l;if(!((n=t.data)!=null&&n.status)||!t.data.data){a("/"),r({message:(u=t.data)==null?void 0:u.msg});return}h({ticket:(c=t.data.data)==null?void 0:c.ticket,expire:(l=t.data.data)==null?void 0:l.expire}),P().then(e=>{var f,m;!((f=e.data)!=null&&f.data)||!((m=e.data)!=null&&m.status)||x.set({...e.data.data.profile,recentActivity:e.data.data.recentActivity,emailVerified:e.data.data.emailVerified})}).finally(()=>a("/"))}).catch(t=>{r({message:t}),a("/")})},[s]),i.jsx(i.Fragment,{children:i.jsx(G,{})})};export{V as default};
