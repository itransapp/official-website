import{r as h,n as e,C as N,M as G,B as J,N as K,O as q,b_ as E,z as r,c1 as Q,c0 as X}from"./index-CdfQvaAC.js";import{L as Y,F as ee}from"./index-CT0eaP_6.js";import{T as se,P as R,c as te,g as ae}from"./oauth2-Di0ms9Kz.js";import{R as ie}from"./index-Bbsk-tbw.js";import{A as D}from"./index-DHiFKBZu.js";import{T as re}from"./Trans-C56zKsEg.js";import{l as M}from"./chunk-4HJHOVVR-BDi0_4ms.js";import{c as I}from"./chunk-H4VOEXHF-CgzhzYkp.js";import{i as U}from"./chunk-UWUNWEEL-D5JstLy5.js";import{c as z}from"./chunk-JHUBASYZ-CB0m0C-x.js";import{i as $}from"./chunk-NNXNFLWG-CweIpbc1.js";import{s as j}from"./chunk-IXXDDLGU-BPztPuYK.js";import{s as le,l as k}from"./chunk-SWJHOPKY-wkBycqPj.js";import"./index-BP6GSUqB.js";import"./chunk-OZXMJY32-J5zo1sif.js";import"./chunk-CIZQCQPA-CUQ3Sjur.js";import"./import-BwPBkkid.js";import"./text-B64jcAFk.js";import"./context-DKp-FRtK.js";import"./import-Cw9Vh-pe.js";import"./useSelectableItem-D18hGpaY.js";import"./chunk-44JHHBS2-DUtZTgkN.js";const ne=t=>{const{children:s=[],showProgressBar:i=!0,defaultActiveStep:v=1,prevText:P,continueText:S,submitText:n,onContinue:u=()=>{},onPrev:a=()=>{},onSubmit:f=()=>{},disableContinue:_=!1,disableSubmit:L=!1,btnPos:o="space-between",barWidth:g="",strokeColor:x="#cdd3d8",fillStroke:A="#3a4047",stroke:w=2,activeColor:d="#3A4047",activeProgressBorder:B="2px solid #f3f4f5",progressBarClassName:T="",contentBoxClassName:W="",allowClickControl:H=!0}=t,[c,y]=h.useState(0);h.useEffect(()=>{v<=s.length&&v>0?(C(v-1),y(v)):(C(0),y(1))},[]),h.useEffect(()=>{s.length>1&&i&&s.map((l,m)=>{const p=document.getElementById(`input_${m}`);p.classList.length>1?(p.style.background=d,p.style.border=B):(p.style.background="#fff",p.style.border="2px solid #3A4047")})},[c]);const O=()=>{if(!c||c<=1)return;C(c-2);const l=c-1;y(l),a(l)},Z=()=>{if(!c||c>=s.length)return;C(c);const l=c+1;y(l),u(l)},F=l=>{H&&(y(l+1),C(l))},C=l=>{var m;if(s.length>1&&i){const p=l/(s.length-1)*100;document.getElementsByClassName("percent")[0].style.width=`${p}%`}if(s.length>1&&i)for(let p=0;p<s.length;p++){const b=document.getElementById(`input_${p}`),V=parseInt((m=b==null?void 0:b.id)==null?void 0:m.split("_")[1]);V===l&&(b.classList.add("selected"),b.classList.remove("completed")),V<=l&&b.classList.add("completed"),V>l&&b.classList.remove("selected","completed")}};return e.jsxs("div",{className:"stepperDiv",children:[s.length>1&&i&&e.jsx("div",{className:`progressBarDiv ${T}`,children:e.jsxs("div",{className:"progressBarContainer",style:{width:g},children:[e.jsx("div",{className:"progress",style:{borderBottom:`${w}px solid ${x}`},children:e.jsx("div",{className:"percent",style:{borderBottom:`${w}px solid ${A}`}})}),e.jsx("div",{className:"steps",children:s.map((l,m)=>e.jsx("div",{className:"step",id:`input_${m}`,onClick:()=>F(m)},m))})]})}),e.jsxs("div",{className:W,children:[s.length>1?s.map((l,m)=>c===m+1&&l):s,e.jsxs("div",{style:{display:"flex",justifyContent:o,marginTop:"20px"},children:[c>1?e.jsx(N,{className:"font-medium",color:"default",onPress:O,children:P||"Prev"}):e.jsx("span",{}),c<s.length?e.jsx(N,{className:"font-medium",color:"primary",onPress:()=>Z(),isDisabled:_,children:S||"Next"}):e.jsx(N,{className:"font-medium",color:"primary",onPress:()=>f(c),isDisabled:L,children:n||"Submit"})]})]})]})},oe=({form:t,setForm:s})=>e.jsxs("div",{children:[e.jsx("div",{children:e.jsx($,{isClearable:!0,className:"font-medium",type:"text",labelPlacement:"outside",label:r("pages.sign_up.step1.input1"),variant:"bordered",placeholder:" ",value:t.firstname,onValueChange:i=>s({...t,firstname:i})})}),e.jsx(j,{y:4}),e.jsx("div",{children:e.jsx($,{isClearable:!0,className:"font-medium",type:"text",labelPlacement:"outside",label:r("pages.sign_up.step1.input2"),variant:"bordered",placeholder:" ",value:t.lastname,onValueChange:i=>s({...t,lastname:i})})}),e.jsx(j,{y:4}),e.jsxs(le,{className:"font-medium",label:r("pages.sign_up.step1.input3"),labelPlacement:"outside",variant:"bordered",placeholder:r("pages.sign_up.step1.input3_placeholder"),onSelectionChange:i=>s({...t,irrigationDitch:i.values().next().value}),children:[e.jsx(k,{children:r("pages.sign_up.step1.options.key1")},"friend-recommend"),e.jsx(k,{children:r("pages.sign_up.step1.options.key2")},"search-engine"),e.jsx(k,{children:r("pages.sign_up.step1.options.key3")},"third-party-website-recommend"),e.jsx(k,{children:r("pages.sign_up.step1.options.key4")},"other")]})]}),de=({form:t,setForm:s})=>e.jsxs("div",{children:[e.jsx("div",{children:e.jsx($,{isClearable:!0,className:"font-medium",type:"email",labelPlacement:"outside",label:r("pages.sign_up.step2.input1"),variant:"bordered",placeholder:" ",isInvalid:!E(t.email),errorMessage:E(t.email)?"":"invalid email address",value:t.email,onValueChange:i=>s({...t,email:i})})}),e.jsx(j,{y:4}),e.jsx("div",{children:e.jsx($,{isClearable:!0,className:"font-medium",type:"text",labelPlacement:"outside",label:r("pages.sign_up.step2.input2"),variant:"bordered",placeholder:" ",value:t.inviteCode,onValueChange:i=>s({...t,inviteCode:i})})})]}),ce=({form:t,setForm:s})=>e.jsxs("div",{children:[e.jsx("div",{children:e.jsx(R,{className:"font-medium",labelPlacement:"outside",label:r("pages.sign_up.step3.input1"),variant:"bordered",placeholder:" ",value:t.password,onValueChange:i=>s({...t,password:i})})}),e.jsx(j,{y:4}),e.jsx("div",{children:e.jsx(R,{className:"font-medium",labelPlacement:"outside",label:r("pages.sign_up.step3.input2"),variant:"bordered",placeholder:" ",value:t.repeatPassword,onValueChange:i=>s({...t,repeatPassword:i}),errorMessage:t.password!==t.repeatPassword?"invalid repeat password":""})}),e.jsx(j,{y:4}),e.jsx("div",{className:"w-full flex justify-center",children:e.jsx(ie,{onValueChange:i=>{s({...t,recaptcha:i})}})}),e.jsx(j,{y:4}),e.jsx("div",{className:"flex items-start",children:e.jsx(te,{onValueChange:i=>s({...t,acceptTerm:i}),children:e.jsx(re,{i18nKey:"pages.sign_up.step3.terms",components:{Link:e.jsx(M,{href:"/docs/t?part=term"})}})})})]}),Le=()=>{const t=G(),s=J(),{authed:i,update:v}=K(),[P,S]=h.useState(!0),[n,u]=h.useState({step:1,disabled:!1}),[a,f]=h.useState({recaptcha:null,acceptTerm:!1,email:"",firstname:"",irrigationDitch:"",lastname:"",password:"",repeatPassword:""}),{show:_}=q(),L=()=>{u({...n,disabled:!0}),Q({email:a.email,password:a.password,firstname:a.firstname,lastname:a.lastname,ticket:a.recaptcha,inviteCode:a.inviteCode,payload:a.authCallback}).then(o=>{var g,x,A,w;if(!((g=o.data)!=null&&g.status)){f({...a,recaptcha:null}),_({message:(x=o.data)==null?void 0:x.msg});return}v({ticket:(A=o.data.data)==null?void 0:A.ticket,expire:(w=o.data.data)==null?void 0:w.expire}),X().then(d=>{var B,T;!((B=d.data)!=null&&B.data)||!((T=d.data)!=null&&T.status)||(s.set({...d.data.data.profile,emailVerified:d.data.data.emailVerified,bindTelegram:d.data.data.bindTelegram,recentActivity:d.data.data.recentActivity,subscription:d.data.data.subscription,twoFactor:d.data.data.twoFactor}),d.data.data.emailVerified||t("/user/verify_email"))}).catch(d=>{_({message:d.toString()})}).finally(()=>t("/"))}).catch(o=>{_({message:o})}).finally(()=>{u({...n,disabled:!1})})};return h.useEffect(()=>{switch(u({...n,disabled:!0}),n.step){case 1:u({...n,disabled:!a.firstname||!a.lastname||!a.irrigationDitch});break;case 2:u({...n,disabled:!a.email||!E(a.email)});break;case 3:u({...n,disabled:!a.recaptcha||!a.password||a.password!==a.repeatPassword||!a.acceptTerm});break}},[a,n.step]),h.useEffect(()=>{if(i()){t("/");return}const o=window.location.hash;if(!o)return;const g=new URLSearchParams(o.substring(1)).get("tgAuthResult");if(!g)return;const x=JSON.parse(atob(g));f({...a,firstname:x.first_name,lastname:x.last_name,authCallback:g}),S(!1)},[]),e.jsxs("div",{className:"flex flex-col items-center justify-center px-6 py-8 mx-auto h-screen lg:py-0",children:[e.jsx(M,{href:"/",children:e.jsx(Y,{className:"select-none",width:200,loading:"lazy"})}),e.jsxs("div",{className:`${P?"":"hidden"} mt-10 flex flex-row justify-between space-x-4 text-medium`,children:[e.jsxs(I,{isFooterBlurred:!0,radius:"lg",className:"border-none",children:[e.jsx(U,{alt:r("pages.sign_up.import_from_telegram"),className:"object-cover",height:200,src:D({src:"/images/gifs/signup_new_account.gif",custom:!0}),width:200,radius:"lg",isZoomed:!0}),e.jsx(z,{className:"p-0 justify-center overflow-hidden absolute before:rounded-xl rounded-large bottom-1 w-[calc(100%_-_8px)] shadow-small ml-1 z-10",children:e.jsx(N,{variant:"solid",color:"primary",radius:"lg",fullWidth:!0,onClick:()=>S(!1),children:r("pages.sign_up.new_account")})})]}),e.jsxs(I,{isFooterBlurred:!0,radius:"lg",className:"border-none",children:[e.jsx(U,{alt:r("pages.sign_up.import_from_telegram"),className:"object-cover",height:200,src:D({src:"/images/gifs/signup_import_from_telegram.gif",custom:!0}),width:200,radius:"lg",isZoomed:!0}),e.jsx(z,{className:"p-0 justify-center overflow-hidden absolute before:rounded-xl rounded-large bottom-1 w-[calc(100%_-_8px)] shadow-small ml-1 z-10",children:e.jsx(N,{variant:"solid",color:"primary",radius:"lg",fullWidth:!0,onClick:()=>{window.location.href=se({botID:"7068700945",origin:ae(),redirectURI:"https://itrans.app/signup"})},children:r("pages.sign_up.import_from_telegram")})})]})]}),e.jsx("div",{className:`w-full mt-6 sm:max-w-md xl:p-5 p-2 ${P?"hidden":""}`,children:e.jsxs(ne,{defaultActiveStep:n.step,showProgressBar:!1,prevText:r("step_prev"),continueText:r("step_next"),submitText:r("pages.sign_up.sign_up"),disableContinue:n.disabled,disableSubmit:n.disabled,onContinue:o=>u({...n,step:o}),onPrev:o=>u({...n,step:o}),onSubmit:L,children:[e.jsx(oe,{form:a,setForm:f}),e.jsx(de,{form:a,setForm:f}),e.jsx(ce,{form:a,setForm:f})]})}),e.jsx(ee.Login,{})]})};export{Le as default};
