import{as as v,K as A,M as y,L as E,z as b,r as g,bc as j,ay as P,l as i,bd as G}from"./index-Bdb2K0In.js";const V=()=>{const[s]=v(),a=A(),{show:r}=y(),{authed:p,update:h}=E(),x=b();return g.useEffect(()=>{if(p()){a("/");return}},[]),g.useEffect(()=>{const d=s.get("state"),o=s.get("code");if(!d||!o){r({message:"invalid params 'state', 'code'"}),setTimeout(()=>a("/login"),1500);return}j({state:d,code:o}).then(t=>{var n,u,c,l;if(!((n=t.data)!=null&&n.status)||!t.data.data){a("/"),r({message:(u=t.data)==null?void 0:u.msg});return}h({ticket:(c=t.data.data)==null?void 0:c.ticket,expire:(l=t.data.data)==null?void 0:l.expire}),P().then(e=>{var f,m;!((f=e.data)!=null&&f.data)||!((m=e.data)!=null&&m.status)||x.set({...e.data.data.profile,recentActivity:e.data.data.recentActivity,emailVerified:e.data.data.emailVerified})}).finally(()=>a("/"))}).catch(t=>{r({message:t}),a("/")})},[s]),i.jsx(i.Fragment,{children:i.jsx(G,{})})};export{V as default};
