import{n as e,z as n,aD as x,aE as N,O as k,r as h,aF as _,C as f}from"./index-D6APwUTW.js";import{O as S,m as $}from"./Open-BeibgfoS.js";import{A}from"./Avatar-D61gq4VA.js";import{L as C,C as Z}from"./ColorDot-B7UR1BHm.js";import{l as u}from"./chunk-4HJHOVVR-5n4F40U5.js";import{o as F}from"./index.module-B3wVe1Kd.js";import{d as g,b,c as j,m as v}from"./chunk-3YEK3JGC-BDcm4Vu4.js";import{i as T}from"./chunk-NNXNFLWG-CROHFMTe.js";import"./import-CJ6h7l8b.js";import"./index-D-5-tOUf.js";import"./scrollIntoView-D0rOy9b1.js";import"./index-GDUb_ijs.js";import"./chunk-YOZJQNDF-D2Go2UR_.js";import"./chunk-OZXMJY32-DHgDBK26.js";import"./chunk-44JHHBS2-Crx0OwVM.js";const z=s=>e.jsxs("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 0 24 24",width:"1em",color:"#a371f7",className:"inline-block overflow-visible align-text-bottom fill-current",...s,children:[e.jsx("path",{d:"M11.28 6.78a.75.75 0 0 0-1.06-1.06L7.25 8.69 5.78 7.22a.75.75 0 0 0-1.06 1.06l2 2a.75.75 0 0 0 1.06 0l3.5-3.5Z"}),e.jsx("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0Zm-1.5 0a6.5 6.5 0 1 0-13 0 6.5 6.5 0 0 0 13 0Z"})]}),E=s=>e.jsx("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 -960 960 960",width:"1em",className:"inline-block overflow-visible align-text-bottom fill-current",...s,children:e.jsx("path",{d:"M240-400h480v-80H240v80Zm0-120h480v-80H240v80Zm0-120h480v-80H240v80ZM880-80 720-240H160q-33 0-56.5-23.5T80-320v-480q0-33 23.5-56.5T160-880h640q33 0 56.5 23.5T880-800v720ZM160-320h594l46 45v-525H160v480Zm0 0v-480 480Z"})}),L=({entry:s})=>e.jsxs("div",{className:"flex flex-auto items-center hover:bg-gray-100 dark:hover:bg-gray-800 rounded-none sm:rounded-lg",children:[e.jsx("div",{className:"flex-shrink-0 pt-2 pl-3",children:s.close?e.jsx(z,{height:"2em",width:"2em"}):e.jsx(S,{height:"2em",width:"2em"})}),e.jsxs("div",{className:"min-w-0 p-2 pr-3 md:pr-2 ",children:[e.jsxs("div",{className:"space-x-2",children:[e.jsx(u,{className:"line-clamp-2 text-large inline",color:"foreground",underline:"hover",style:{userSelect:"text"},href:`/chalkboard/${s.id.toString()}`,children:s.title}),e.jsx("div",{className:"inline",children:s.labels?e.jsx(C,{size:"sm",labels:s.labels}):e.jsx(e.Fragment,{})})]}),e.jsxs("div",{className:"text-gray-400",style:{fontSize:"13px"},children:[`#${s.id.toString(16).slice(0,8)} `,s.close?e.jsxs(e.Fragment,{children:[e.jsx(u,{size:"sm",href:`/user/${s.username||s.author.toString()}`,children:s.username?`@${s.username}`:`@${s.author.toString(16).slice(0,8)}`}),e.jsx("p",{className:"inline ml-1",children:n("pages.chalkboard.was_closed_ago",{created_at:x(s.updatedAt)})})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"inline",children:n("pages.chalkboard.opened_ago",{created_at:x(s.createdAt)})}),e.jsx(u,{className:"ml-1",size:"sm",href:`/user/${s.username||s.author.toString()}`,children:s.username?`@${s.username}`:`@${s.author.toString(16).slice(0,8)}`})]})]})]}),e.jsxs("div",{className:"hidden sm:flex ml-auto flex-shrink-0 items-center justify-between text-right pr-3 whitespace-nowrap ",children:[e.jsx("span",{className:"ml-2 flex-1 flex-shrink-0",children:e.jsx(A,{alt:s.username||s.author.toString(),size:"sm",src:s.username?`@${s.username}`:s.author.toString()})}),e.jsxs("span",{className:"ml-6 flex-1 flex-shrink-0 items-center content-center text-gray-700 dark:text-gray-300",children:[e.jsx(E,{width:"1rem",height:"1rem",className:"inline-flex overflow-visible fill-current"}),e.jsx("span",{className:"ml-1 text-small font-bold",children:s.comments})]})]})]}),M=({entries:s})=>e.jsx("div",{className:"w-full divide-y divide-gray-200 dark:divide-gray-700",children:s.map((t,a)=>e.jsx(L,{entry:t},a))}),O=s=>e.jsx("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 -960 960 960",width:"1em",className:"inline-block overflow-visible align-text-bottom fill-current",...s,children:e.jsx("path",{d:"M480-360 280-560h400L480-360Z"})}),p={is:{open:()=>({open:!0})},author:{"@me":()=>({author:"self"}),"*":s=>s.charAt(0)==="@"?{author:s.slice(1,s.length)}:{author:s}},mentions:{"@me":()=>({mentions:"self"}),"*":s=>s.charAt(0)==="@"?{mentions:s.slice(1,s.length)}:{mentions:s}},label:{"*":s=>({label:[s.slice(1,s.length-1)]})}},y=s=>{const t={};return s.split(" ").reduce((a,l)=>{const[o,m]=l.split(":");if(o&&m){const i=o.trim(),d=m.trim();a[i]||(a[i]=new Set),a[i].has(i)||a[i].add(d)}return a},t),Object.fromEntries(Object.entries(t).map(([a,l])=>[a,[...l]]))},H=s=>{const t=[],a=y(s);for(const[l,o]of Object.entries(a))p[l]&&o.forEach(m=>{(p[l][m]||p[l]["*"])&&t.push(`${l}:${m}`)});return t.join(" ")},q=[{name:n("pages.chalkboard.filter_options.opened"),rules:"is:open"},{name:n("pages.chalkboard.filter_options.me"),rules:"author:@me"},{name:n("pages.chalkboard.filter_options.mention_me"),rules:"is:open mentions:@me"}],se=()=>{const{labels:s}=N(),{show:t}=k(),[a,l]=h.useState({total:0,offset:0,limit:10}),[o,m]=h.useState(void 0),[i,d]=h.useState("is:open"),[w]=F(i,1e3);return h.useEffect(()=>{i&&d(H(i))},[w]),h.useEffect(()=>{_({offset:a.offset,limit:a.limit,labels:[],sort:1}).then(r=>{var c;if(!r.data){t({message:"Failed to fetch chalkboards"});return}if(!r.data.status||!r.data.data){t({message:(c=r.data)==null?void 0:c.msg});return}r.data.data.total!==0&&(l({...a,total:r.data.data.total}),m(r.data.data.list))}).catch(r=>{t({message:r.toString()})})},[a.limit,a.offset]),e.jsxs("div",{className:"sm:pl-2 sm:pr-2",children:[e.jsxs("div",{className:"pb-2 flex gap-2",children:[e.jsx(T,{variant:"faded",classNames:{inputWrapper:"pl-0 h-unit-10 rounded-medium rounded-l-none sm:rounded-l-medium"},color:"primary",radius:"md",startContent:e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(f,{endContent:e.jsx(O,{width:"1.25rem",height:"1.25rem"}),size:"md",className:"font-medium",variant:"light",children:n("pages.chalkboard.filter")})}),e.jsx(j,{"aria-label":"chalkboard filter options",children:q.map((r,c)=>e.jsx(v,{onClick:()=>d(r.rules),children:r.name},c))})]}),value:i,onValueChange:d}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(f,{className:"hidden md:flex font-medium",variant:"bordered",color:"secondary",children:n("label")})}),e.jsx(j,{"aria-label":"label filter",selectionMode:"single",onAction:r=>{d(`${i} label:"${s[r].name}"`)},children:e.jsx($,{title:"Filter by label",children:s.map((r,c)=>e.jsx(v,{textValue:r.name,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Z,{color:r.color,width:"1rem",height:"1rem"}),e.jsx("div",{className:"ml-2 truncate min-w-0 flex items-center",children:e.jsx("div",{className:"font-medium",children:r.name})})]})},c))})})]}),e.jsx(f,{className:"hidden md:flex font-medium",color:"primary",as:u,href:"/chalkboard/new",children:n("pages.chalkboard.new_long")}),e.jsx(f,{className:"flex md:hidden rounded-r-none sm:rounded-r-medium font-medium",color:"primary",as:u,href:"/chalkboard/new",children:n("pages.chalkboard.new_short")})]}),e.jsx("div",{children:o?e.jsx(M,{entries:o}):e.jsx("div",{className:"py-3 flex items-center text-md text-gray-400 uppercase before:flex-1 before:border-t before:border-gray-200 before:me-6 after:flex-1 after:border-t after:border-gray-200 after:ms-6 dark:text-gray-500 dark:before:border-gray-600 dark:after:border-gray-600",children:n("empty")})})]})};export{se as default};
