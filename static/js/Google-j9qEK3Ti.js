import{bT as v,M as A,O as E,N as b,B as j,r as g,cf as y,bZ as P,n as i,cg as B}from"./index-wNxkLrUB.js";const N=()=>{const[s]=v(),a=A(),{show:r}=E(),{authed:p,update:h}=b(),x=j();return g.useEffect(()=>{if(p()){a("/");return}},[]),g.useEffect(()=>{const o=s.get("state"),d=s.get("code");if(!o||!d){r({message:"invalid params 'state', 'code'"}),setTimeout(()=>a("/login"),1500);return}y({state:o,code:d}).then(t=>{var n,u,c,f;if(!((n=t.data)!=null&&n.status)||!t.data.data){a("/"),r({message:(u=t.data)==null?void 0:u.msg});return}h({ticket:(c=t.data.data)==null?void 0:c.ticket,expire:(f=t.data.data)==null?void 0:f.expire}),P().then(e=>{var l,m;!((l=e.data)!=null&&l.data)||!((m=e.data)!=null&&m.status)||x.set({...e.data.data.profile,recentActivity:e.data.data.recentActivity,emailVerified:e.data.data.emailVerified})}).finally(()=>a("/"))}).catch(t=>{r({message:t}),a("/")})},[s]),i.jsx(i.Fragment,{children:i.jsx(B,{})})};export{N as default};
