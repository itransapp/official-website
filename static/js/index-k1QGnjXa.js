import{aZ as f,r as i}from"./index-CydsovlJ.js";var o=(a=>(a.Avatar="/file/avatar",a.Custom="",a))(o||{});const b=(a="/file/avatar",t)=>{const e=new FormData;return e.append("file",t),f("POST",a,{file:!0,data:e})},m=2,l=new Map,v=(()=>{const a={"/file/avatar":0,"":0};return async(t="/file/avatar",e)=>{for(;a[t]>=m;)await new Promise(g=>setTimeout(g,50));a[t]++;let r;switch(t){case"/file/avatar":r=`/file/avatar/${e}`;break;case"":r=e;break}const s=l.get(r);if(s)return a[t]--,s;const c=await f("GET",r,{mustJSON:!1,local:t===""});if(c.statusCode!==200)throw a[t]--,"failed to fetch file";const n=URL.createObjectURL(c.blob);return l.set(r,n),a[t]--,n}})(),u="/images/default-avatar.jpg",w="/images/default-background.jpg",h="/images/backtrace.svg",L="/images/logo.png",A=({src:a,backtrace:t,custom:e})=>{const[r,s]=i.useState(t||h);return i.useEffect(()=>{v(a===u||e?o.Custom:o.Avatar,a).then(c=>{s(c)}).catch(()=>{s(t||u)})}),r};export{A,u as D,L,b as U,o as a,w as b};
