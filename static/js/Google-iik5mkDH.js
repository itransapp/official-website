import{ao as v,J as A,L as y,K as E,y as b,r as g,b6 as j,au as P,l as i,b7 as G}from"./index-B33sEYiV.js";const V=()=>{const[e]=v(),s=A(),{show:r}=y(),{authed:p,update:h}=E(),x=b();return g.useEffect(()=>{if(p()){s("/");return}},[]),g.useEffect(()=>{const o=e.get("state"),d=e.get("code");if(!o||!d){r({message:"invalid params 'state', 'code'"}),setTimeout(()=>s("/login"),1500);return}j({state:o,code:d}).then(t=>{var n,u,c,l;if(!((n=t.data)!=null&&n.status)||!t.data.data){r({message:(u=t.data)==null?void 0:u.msg});return}h({ticket:(c=t.data.data)==null?void 0:c.ticket,expire:(l=t.data.data)==null?void 0:l.expire}),P().then(a=>{var f,m;!((f=a.data)!=null&&f.data)||!((m=a.data)!=null&&m.status)||x.set({...a.data.data.profile,recentActivity:a.data.data.recentActivity,emailVerified:a.data.data.emailVerified})}).finally(()=>s("/"))}).catch(t=>r({message:t}))},[e]),i.jsx(i.Fragment,{children:i.jsx(G,{})})};export{V as default};
