import{k as H,i as B,c as I,l as e,r as f,z as g,J as E,N as L,L as Q,y as U,W,X as V,Y as G,Z as J}from"./index-CP6YXhxA.js";import{m as y,O as K}from"./Open-D-F2UbYF.js";import{A as X,f as Y,a as ee}from"./Avatar-RhHvXwFG.js";import{f as te,t as se}from"./text-DMYT1VWy.js";import{e as R,f as D,g as Z,d as ae,b as re,c as ne,m as T}from"./chunk-L6QJ42W6-DohJcDIq.js";import{F as le,u as ie,P as oe}from"./Preview-7qI1DyrQ.js";import{R as de,t as me}from"./Report-tDahxdHO.js";import{d as N}from"./chunk-44JHHBS2-BxgHoykE.js";import{u as ce,c as F,a as A,b as P}from"./chunk-BJUMDPFJ-DuVeU42t.js";import{R as he}from"./index-BCfq5wFC.js";import{m as ue,a as fe,b as xe,c as pe,d as je}from"./chunk-II5OMS4Q-DwQ4THWp.js";import{c as ge}from"./chunk-OFH6WYRQ-BzWd7LIM.js";import{l as ve}from"./chunk-MPX6TMFQ-DgX7tMJz.js";import"./import-ch58Z01W.js";import"./index-B426X8vB.js";import"./index-_JI0cjyd.js";import"./chunk-CAFRINWI-CcU5yOMx.js";import"./Combination-DKfVhoKJ.js";import"./index-B6bTAOOk.js";import"./import-Gwtq0FJH.js";import"./chunk-LY2CD73K-D0ULdjO0.js";var M=H((r,x)=>{var n;const{as:h,className:i,children:a,...s}=r,u=h||"div",o=B(x),{slots:j,classNames:d}=ce(),b=I(d==null?void 0:d.footer,i);return e.jsx(u,{ref:o,className:(n=j.footer)==null?void 0:n.call(j,{class:b}),...s,children:a})});M.displayName="NextUI.CardFooter";var O=M;const be=r=>e.jsx("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 -960 960 960",width:"1em",className:"inline-block overflow-visible align-text-bottom fill-current",...r,children:e.jsx("path",{d:"M480-480Zm0 400q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q43 0 83 8.5t77 24.5v90q-35-20-75.5-31.5T480-800q-133 0-226.5 93.5T160-480q0 133 93.5 226.5T480-160q133 0 226.5-93.5T800-480q0-32-6.5-62T776-600h86q9 29 13.5 58.5T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm320-600v-80h-80v-80h80v-80h80v80h80v80h-80v80h-80ZM620-520q25 0 42.5-17.5T680-580q0-25-17.5-42.5T620-640q-25 0-42.5 17.5T560-580q0 25 17.5 42.5T620-520Zm-280 0q25 0 42.5-17.5T400-580q0-25-17.5-42.5T340-640q-25 0-42.5 17.5T280-580q0 25 17.5 42.5T340-520Zm140 260q68 0 123.5-38.5T684-400H276q25 63 80.5 101.5T480-260Z"})}),qe=["ðŸ‘","ðŸ‘Ž","ðŸ˜","ðŸŽ‰","â¤ï¸","ðŸ‘€","ðŸ’©"],Te=({username:r,reactions:x,onReactions:n})=>{const[h,i]=f.useState(()=>{const a={};for(let s=0;s<x.length;s++)a[s]=!1;return a});return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(R,{placement:"top-start",backdrop:"opaque",radius:"sm",children:[e.jsx(D,{children:e.jsx(g,{className:"text-lg",variant:"flat",radius:"full",size:"sm",isIconOnly:!0,children:e.jsx(be,{})})}),e.jsx(Z,{children:e.jsx("div",{className:"flex gap-1",children:qe.map((a,s)=>e.jsx(g,{className:"inline-block text-lg",isIconOnly:!0,size:"sm",variant:"light",children:a},s))})})]}),x.map((a,s)=>{const u=a.users.indexOf(r)!==-1;return e.jsxs(R,{isOpen:h[s],onOpenChange:o=>i({...h,[s]:o}),showArrow:!0,radius:"sm",children:[e.jsx(D,{children:e.jsxs(g,{className:"text-md",variant:u?"solid":"bordered",color:u?"primary":"default",radius:"full",size:"sm",onMouseEnter:()=>i({...h,[s]:!0}),onMouseLeave:()=>i({...h,[s]:!1}),onClick:()=>{i({...h,[s]:!1}),n&&n(u,a.emoji)},children:[a.emoji," ",a.users.length]})}),e.jsx(Z,{className:"text-gray-500 dark:text-gray-400",style:{maxWidth:"300px"},children:te(a.emoji,a.users)})]},s)})]})},Ne=r=>e.jsx("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 -960 960 960",width:"1em",className:"inline-block overflow-visible align-text-bottom fill-current",...r,children:e.jsx("path",{d:"M240-400q-33 0-56.5-23.5T160-480q0-33 23.5-56.5T240-560q33 0 56.5 23.5T320-480q0 33-23.5 56.5T240-400Zm240 0q-33 0-56.5-23.5T400-480q0-33 23.5-56.5T480-560q33 0 56.5 23.5T560-480q0 33-23.5 56.5T480-400Zm240 0q-33 0-56.5-23.5T640-480q0-33 23.5-56.5T720-560q33 0 56.5 23.5T800-480q0 33-23.5 56.5T720-400Z"})}),we=r=>e.jsx("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 -960 960 960",width:"1em",className:"inline-block overflow-visible align-text-bottom fill-current",...r,children:e.jsx("path",{d:"M727-80q-47.5 0-80.75-33.346Q613-146.693 613-194.331q0-6.669 1.5-16.312T619-228L316-404q-15 17-37 27.5T234-366q-47.5 0-80.75-33.25T120-480q0-47.5 33.25-80.75T234-594q23 0 44 9t38 26l303-174q-3-7.071-4.5-15.911Q613-757.75 613-766q0-47.5 33.25-80.75T727-880q47.5 0 80.75 33.25T841-766q0 47.5-33.25 80.75T727-652q-23.354 0-44.677-7.5T646-684L343-516q2 8 3.5 18.5t1.5 17.741q0 7.242-1.5 15Q345-457 343-449l303 172q15-14 35-22.5t46-8.5q47.5 0 80.75 33.25T841-194q0 47.5-33.25 80.75T727-80Zm.035-632Q750-712 765.5-727.535q15.5-15.535 15.5-38.5T765.465-804.5q-15.535-15.5-38.5-15.5T688.5-804.465q-15.5 15.535-15.5 38.5t15.535 38.465q15.535 15.5 38.5 15.5Zm-493 286Q257-426 272.5-441.535q15.5-15.535 15.5-38.5T272.465-518.5q-15.535-15.5-38.5-15.5T195.5-518.465q-15.5 15.535-15.5 38.5t15.535 38.465q15.535 15.5 38.5 15.5Zm493 286Q750-140 765.5-155.535q15.5-15.535 15.5-38.5T765.465-232.5q-15.535-15.5-38.5-15.5T688.5-232.465q-15.5 15.535-15.5 38.5t15.535 38.465q15.535 15.5 38.5 15.5ZM727-766ZM234-480Zm493 286Z"})}),Ce=r=>e.jsx("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 -960 960 960",width:"1em",className:"inline-block overflow-visible align-text-bottom fill-current",...r,children:e.jsx("path",{d:"M780-200v-156q0-60-39-99t-99-39H236l163 163-43 43-236-236 236-236 43 43-163 163h406q85 0 141.5 56.5T840-356v156h-60Z"})}),_e=r=>e.jsx("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 -960 960 960",width:"1em",className:"inline-block overflow-visible align-text-bottom fill-current",...r,children:e.jsx("path",{d:"M280-120q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM360-280h80v-360h-80v360Zm160 0h80v-360h-80v360ZM280-720v520-520Z"})}),S=({cid:r,id:x,firstname:n,lastname:h,username:i,content:a,createdAt:s,allowedDelete:u,followed:o,showFollow:j,onFollow:d,onReply:b,onDelete:m,reactions:c})=>{const[p,q]=f.useState(!1);return e.jsxs(F,{fullWidth:!0,classNames:{base:"rounded-r-none md:rounded-r-lg rounded-l-none md:rounded-l-lg"},children:[e.jsxs(A,{className:"justify-between",children:[e.jsxs("div",{className:"flex gap-5",children:[e.jsx(X,{radius:"full",size:"md",src:`@${i}`}),e.jsxs("div",{className:"flex flex-col gap-1 items-start justify-center",children:[e.jsxs("h4",{className:"text-medium font-semibold leading-none text-default-600",children:[n," ",h]}),e.jsx(e.Fragment,{children:i?e.jsxs("h5",{className:"text-small tracking-tight text-default-400",children:["@",i]}):null})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{className:`font-medium ${j?"":"hidden"} ${o?"bg-transparent text-foreground border-default-200":""}`,color:"primary",radius:"full",size:"sm",variant:o?"bordered":"solid",onPress:d,isDisabled:!0,children:o?"Unfollow":"Follow"}),e.jsxs(ae,{size:"sm",children:[e.jsx(re,{children:e.jsx(g,{size:"sm",isIconOnly:!0,variant:"light",children:e.jsx(Ne,{width:"1.25rem",height:"1.25rem"})})}),e.jsxs(ne,{"aria-label":"comment actions",disabledKeys:p?["share"]:void 0,children:[e.jsxs(y,{title:"Actions",showDivider:!0,children:[e.jsx(T,{startContent:e.jsx(we,{width:"1.25rem",height:"1.25rem"}),onPress:()=>{navigator.clipboard.writeText(`https://itrans.app/chalkboard/${r}?${new URLSearchParams({mid:x.toString(16)})}`).then(()=>{q(!0),setTimeout(()=>{q(!1)},1500)})},children:p?"Copy Success":"Copy link"},"share"),e.jsx(T,{startContent:e.jsx(Ce,{width:"1.25rem",height:"1.25rem"}),onPress:b,children:"Reply"},"reply"),e.jsx(T,{startContent:e.jsx(_e,{width:"1.25rem",height:"1.25rem"}),onPress:m,className:`${u?"":"hidden"}`,children:"Delete"},"delete")]}),e.jsx(y,{title:"Feedback",children:e.jsx(T,{startContent:e.jsx(de,{width:"1.25rem",height:"1.25rem"}),color:"danger",className:"text-danger",children:"Report content"},"report")})]})]})]})]}),e.jsx(N,{}),e.jsxs(P,{children:[e.jsx(le,{className:"pt-2 pb-2 pr-1 pl-1",children:decodeURIComponent(a)}),c!=null&&c.reactions?e.jsx("div",{className:"mt-3",children:e.jsx(Te,{username:c.username,reactions:c.reactions,onReactions:c.onReactions})}):null]}),e.jsx(N,{}),e.jsx(O,{className:"gap-3",children:e.jsxs("span",{className:"text-small text-gray-500",children:["commented on ",Y(s)," â€¢ edited"]})})]})},ye={close:!1,id:7164271119128596480n,author:BigInt(1),username:"Z-Siqi",comments:1,title:"æ–°åŠ å¡ Mount Elizabeth åŒ»é™¢çš„ Alex Fok åŒ»ç”Ÿå¯ä»¥ç»™16å²å¼€HRTæ²»ç–—",contentPreview:"Hello",labels:[{name:"å†…å®¹",color:"#4feeff"},{name:"HRT",color:"#0be01f"}],createdAt:new Date,updatedAt:new Date},Ge=()=>{const r=E(),x=L(),{show:n}=Q(),{isOpen:h,onOpenChange:i}=ie(),{profile:a}=U(),[s,u]=f.useState({author:0n,close:!1,comments:0,content:"",createdAt:new Date,firstname:"",labels:[],lastname:"",reactions:[],title:"",updatedAt:new Date,username:""}),[o,j]=f.useState([]),[d,b]=f.useState(0n),[m,c]=f.useState({description:"",recaptcha:null}),[p,q]=f.useState({total:0,offset:0,limit:10,beforeOffset:0}),$=()=>{V({offset:p.offset,limit:p.limit,cid:d}).then(t=>{var l;if(!t.data){n({message:"Failed to fetch chalkboard comments"});return}if(!t.data.status||!t.data.data){n({message:(l=t.data)==null?void 0:l.msg});return}t.data.data.total!==0&&(j([...o,...t.data.data.list]),q({...p,total:t.data.data.total,beforeOffset:p.offset}))}).catch(t=>n({message:t}))},z=()=>{a&&(i(),G({cid:d,content:m.description,ticket:m.recaptcha||""}).then(t=>{var l,v;if(!((l=t.data)!=null&&l.status)){n({message:(v=t.data)==null?void 0:v.msg});return}j([...o,{id:t.data.data||0n,author:a.id,username:a.username,firstname:a.firstname,lastname:a.lastname,content:m.description,reactions:[],createdAt:new Date,updatedAt:new Date}]),c({description:"",recaptcha:null,reply:void 0})}).catch(t=>n({message:t})))},k=(t,l)=>{J({cid:d,tid:l}).then(v=>{var C,_;if(!((C=v.data)!=null&&C.status)){n({message:(_=v.data)==null?void 0:_.msg});return}j([...o.slice(0,t),...o.slice(t+1,o.length)]),u({...s,comments:s.comments-1})}).catch(v=>n({message:v}))},w=f.useCallback(t=>{c(l=>({...l,description:t}))},[]);return f.useEffect(()=>{const t=x.id;if(!t){r("/chalkboard");return}const l=me(t);if(!l){r("/chalkboard");return}b(l)},[x]),f.useEffect(()=>{d&&(s.title||W({id:d}).then(t=>{if(!t.data){n({message:"Failed to fetch chalkboard details"});return}if(!t.data.status||!t.data.data){n({message:t.data.msg});return}u(t.data.data)}).catch(t=>n({message:t})),$())},[d,p.limit,p.offset]),e.jsxs("div",{className:"md:w-10/12 ml-auto mr-auto mt-8",children:[e.jsx(ue,{isOpen:h,onOpenChange:i,children:e.jsx(fe,{children:t=>e.jsxs(e.Fragment,{children:[e.jsx(xe,{children:"Verify your is human"}),e.jsx(pe,{className:"flex items-center justify-center",children:e.jsx(he,{onValueChange:l=>c({...m,recaptcha:l})})}),e.jsxs(je,{children:[e.jsx(g,{color:"danger",variant:"light",onPress:t,children:"Cancel"}),e.jsx(g,{color:"primary",onPress:z,isDisabled:!m.recaptcha,children:"Submit"})]})]})})}),e.jsxs("div",{className:"block w-full",children:[e.jsxs("h1",{className:"text-3xl",children:[e.jsx("bdi",{className:"break-words tracking-tight",children:s.title}),e.jsx("span",{className:"text-2xl text-gray-500",children:` #${d.toString(16).slice(0,8)}`})]}),e.jsx("div",{className:"flex mt-2 items-center",children:e.jsxs(e.Fragment,{children:[e.jsx(ge,{startContent:e.jsx(K,{height:"2em",width:"2em",style:{marginTop:"0.5rem",fill:"#FFFFFF"}}),className:"text-white pl-2",classNames:{content:"pl-0"},variant:"solid",color:"success",children:e.jsx("p",{className:"text-large font-medium",children:"Open"})}),e.jsxs("div",{className:"inline ml-2 text-gray-500 text-small",children:[e.jsx(ve,{size:"sm",href:`/user/${s.username}`,className:"mr-1 font-medium text-medium text-gray-500",children:`@${s.username}`}),"opened this chalkboard on ",ee(ye.createdAt)," Â· ",s.comments," comments"]})]})})]}),e.jsx(N,{className:"mt-5 mb-5"}),e.jsx("div",{className:"flex gap-10",children:e.jsxs("div",{className:"w-full space-y-4",children:[e.jsx(S,{cid:d,id:0n,firstname:s.firstname,lastname:s.lastname,username:s.username||"",content:s.content,createdAt:s.createdAt,reactions:{username:"",reactions:s.reactions||[]},allowedDelete:!1,onDelete:()=>{},onReply:()=>c({...m,reply:void 0})}),o.map((t,l)=>e.jsx(S,{...t,username:t.username||"",cid:d,onReply:()=>{c({...m,reply:t.id}),w(`${se(t.content)}

${m.description}`)},allowedDelete:(a==null?void 0:a.id.toString())===t.author.toString(),onFollow:()=>{},onDelete:()=>k(l,t.id),reactions:{username:"",reactions:t.reactions||[]}},l)),a?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"mt-5 mb-5"}),e.jsxs(F,{fullWidth:!0,children:[e.jsx(A,{className:"pb-0",children:e.jsx("span",{className:"font-medium",children:"Add a comment"})}),e.jsx(P,{className:"pb-1",children:e.jsx(oe,{className:"w-full max-h-screen",color:"primary",content:m.description,setContent:w,classNames:{panel:"px-0"},minRows:5,maxRows:15})}),e.jsxs(O,{className:"pt-1 flex justify-between items-center",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm font-medium text-transgender",children:["Remember, that your Comment should adhere to the ",e.jsx("p",{className:"font-bold inline",children:"iTrans Community Content Guidelines"})]})}),e.jsx(g,{className:"font-medium",color:"primary",isDisabled:!m.description,onPress:i,children:"Submit"})]})]})]}):null]})})]})};export{Ge as default};
