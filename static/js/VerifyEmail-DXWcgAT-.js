import{R as g,r as y,n as o,M as $,O as z,B as G,C as H,W as J,X as Q}from"./index-CZ9qgNtX.js";import{l as Y}from"./chunk-4HJHOVVR-DuQboD7r.js";var F=function(n){return typeof n=="object"&&n!==null},Z=function(n){var i=n.value,c=i===void 0?"":i,m=n.numInputs,r=m===void 0?4:m,I=n.onChange,N=n.onPaste,A=n.renderInput,f=n.shouldAutoFocus,D=f===void 0?!1:f,j=n.inputType,x=j===void 0?"text":j,b=n.renderSeparator,v=n.placeholder,a=n.containerStyle,S=n.inputStyle,O=n.skipDefaultStyles,B=O===void 0?!1:O,R=g.useState(0),l=R[0],V=R[1],h=g.useRef([]),E=function(){return c?c.toString().split(""):[]},C=x==="number"||x==="tel";g.useEffect(function(){h.current=h.current.slice(0,r)},[r]),g.useEffect(function(){var e;D&&((e=h.current[0])===null||e===void 0||e.focus())},[D]);var _=function(){if(typeof v=="string"){if(v.length===r)return v;v.length>0&&console.error("Length of the placeholder should be equal to the number of inputs.")}},T=function(e){var t=C?!isNaN(Number(e)):typeof e=="string";return t&&e.trim().length===1},q=function(e){var t=e.target.value;T(t)&&(w(t),p(l+1))},L=function(e){var t=e.nativeEvent,s=e.target.value;if(!T(s)){if(s.length===r){var u=s.split("").some(function(d){return!T(d)});u||(k(s.split("")),p(r-1))}t.data===null&&t.inputType==="deleteContentBackward"&&(e.preventDefault(),w(""),p(l-1)),e.target.value=""}},M=function(e){return function(t){V(t),e.target.select()}},K=function(){V(l-1)},U=function(e){var t=E();[e.code,e.key].includes("Backspace")?(e.preventDefault(),w(""),p(l-1)):e.code==="Delete"?(e.preventDefault(),w("")):e.code==="ArrowLeft"?(e.preventDefault(),p(l-1)):e.code==="ArrowRight"||e.key===t[l]?(e.preventDefault(),p(l+1)):(e.code==="Spacebar"||e.code==="Space"||e.code==="ArrowUp"||e.code==="ArrowDown")&&e.preventDefault()},p=function(e){var t,s,u=Math.max(Math.min(r-1,e),0);h.current[u]&&((t=h.current[u])===null||t===void 0||t.focus(),(s=h.current[u])===null||s===void 0||s.select(),V(u))},w=function(e){var t=E();t[l]=e[0],k(t)},k=function(e){var t=e.join("");I(t)},W=function(e){var t;e.preventDefault();var s=E(),u=l,d=e.clipboardData.getData("text/plain").slice(0,r-l).split("");if(!(C&&d.some(function(X){return isNaN(Number(X))}))){for(var P=0;P<r;++P)P>=l&&d.length>0&&(s[P]=(t=d.shift())!==null&&t!==void 0?t:"",u++);p(u),k(s)}};return g.createElement("div",{style:Object.assign({display:"flex",alignItems:"center"},F(a)&&a),className:typeof a=="string"?a:void 0,onPaste:N},Array.from({length:r},function(e,t){return t}).map(function(e){var t,s,u;return g.createElement(g.Fragment,{key:e},A({value:(t=E()[e])!==null&&t!==void 0?t:"",placeholder:(u=(s=_())===null||s===void 0?void 0:s[e])!==null&&u!==void 0?u:void 0,ref:function(d){return h.current[e]=d},onChange:q,onFocus:function(d){return M(d)(e)},onBlur:K,onKeyDown:U,onPaste:W,autoComplete:"off","aria-label":"Please enter OTP character ".concat(e+1),style:Object.assign(B?{}:{width:"1em",textAlign:"center"},F(S)?S:{}),className:typeof S=="string"?S:void 0,type:x,inputMode:C?"numeric":"text",onInput:L},e),e<r-1&&(typeof b=="function"?b(e):b))}))};const ee=({max:n,value:i,onValueChange:c,onFinish:m})=>(y.useEffect(()=>{i.length===n&&m&&m()},[i]),o.jsx(Z,{value:i,onChange:c,numInputs:n,renderSeparator:"",renderInput:r=>o.jsx("input",{...r,style:{width:""}}),inputType:"text",shouldAutoFocus:!0,inputStyle:"w-14 text-center text-2xl font-medium focus:outline-none focus:ring-2 rounded-lg px-4 py-3 ring-2 ring-gray-600 dark:ring-gray-400",containerStyle:"space-x-2"})),ae=()=>{const n=$(),{show:i}=z(),{profile:c,set:m}=G(),[r,I]=y.useState(""),[N,A]=y.useState(""),[f,D]=y.useState(0),[j,x]=y.useState(!1),b=()=>{if(r.length!==6||!N||!c){i({message:"invalid verify email request"});return}x(!0),J({token:N,code:r}).then(a=>{if(!a.data){i({message:"failed to send verify email request"});return}if(!a.data.status){i({message:a.data.msg});return}m({...c,emailVerified:!0}),n("/user/@me")}).catch(a=>i({message:a})).finally(()=>x(!1))},v=()=>{I(""),Q().then(a=>{if(!a.data){i({message:"failed to send verify email request"});return}if(!a.data.status||!a.data.data){i({message:a.data.msg});return}A(a.data.data),D(60)}).catch(a=>i({message:a}))};return y.useEffect(()=>{if(c!=null&&c.emailVerified){n("/");return}v()},[]),y.useEffect(()=>{if(f<=0)return;const a=setInterval(()=>{D(S=>S-1),f===0&&clearInterval(a)},1e3);return()=>clearInterval(a)},[f]),o.jsxs("div",{className:"max-w-md mx-auto text-center px-4 sm:px-8 py-16",children:[o.jsxs("div",{className:"mb-8",children:[o.jsx("h1",{className:"text-2xl font-bold mb-1",children:"Email Address Verification"}),o.jsx("p",{className:"text-gray-400 dark:text-gray-600",children:"Enter the 6-digit verification code that was sent to your mailbox."})]}),o.jsx("div",{children:o.jsx(ee,{max:6,value:r,onValueChange:I,onFinish:b})}),o.jsx("div",{className:"max-w-[260px] mx-auto mt-5",children:o.jsx(H,{fullWidth:!0,color:"primary",className:"font-medium",onPress:b,isDisabled:j,children:"Verify account"})}),o.jsx("div",{className:"mt-4",children:o.jsxs("span",{className:"text-sm text-gray-400 dark:text-gray-600 ",children:["Didn't receive code? Â ",o.jsxs(Y,{className:"text-sm font-medium",onPress:v,isDisabled:f!==0,children:["Resend",f!==0?`(${f.toString()})`:null]})]})})]})};export{ae as default};
