import{r as o}from"./index-BIm2R1bB.js";var v=globalThis!=null&&globalThis.document?o.useLayoutEffect:o.useEffect;function S(p={}){const{loading:t,src:n,srcSet:i,onLoad:l,onError:a,crossOrigin:u,sizes:c,ignoreFallback:f}=p,[d,g]=o.useState("pending");o.useEffect(()=>{g(n?"loading":"pending")},[n]);const r=o.useRef(),E=o.useCallback(()=>{if(!n)return;s();const e=new Image;e.src=n,u&&(e.crossOrigin=u),i&&(e.srcset=i),c&&(e.sizes=c),t&&(e.loading=t),e.onload=m=>{s(),g("loaded"),l==null||l(m)},e.onerror=m=>{s(),g("failed"),a==null||a(m)},r.current=e},[n,u,i,c,l,a,t]),s=()=>{r.current&&(r.current.onload=null,r.current.onerror=null,r.current=null)};return v(()=>{if(!f)return d==="loading"&&E(),()=>{s()}},[d,E,f]),f?"loaded":d}export{S as u};
