import{t as fe,d as xe,l as e,n as he,k as T,i as B,r as l,c as N,e as M,K as V,o as L,L as be,M as ve,N as ge,m as ye,v as je,$ as we,O as qe,f as P,A as Ne,p as Te,P as G,U as J,z as U,y as Ce,Q as ke,R as Pe}from"./index-Bm0YF5iz.js";import{c as R,f as H,g as K}from"./date-DQyi17Dz.js";import{i as $}from"./validator-CEpkGiwj.js";import{o as $e}from"./index.module-lz_V4xhJ.js";import{T as A,a as Me,$ as Be}from"./import-DkQ-DLrk.js";import{$ as Ie,R as Oe,a as Se}from"./Combination-BTcB89QM.js";import{i as Ze}from"./chunk-TC4QW7OA-fEiEc1BK.js";import"./chunk-M3MASYO7-BXOdcU6G.js";import"./chunk-CAFRINWI-CcU5yOMx.js";import"./index-B4tftrdQ.js";var Q=fe({slots:{wrapper:["flex","w-screen","h-[100dvh]","fixed","inset-0","z-50","overflow-x-auto","justify-center","[--scale-enter:100%]","[--scale-exit:100%]","[--slide-enter:0px]","[--slide-exit:80px]","sm:[--scale-enter:100%]","sm:[--scale-exit:103%]","sm:[--slide-enter:0px]","sm:[--slide-exit:0px]"],base:["flex","flex-col","relative","bg-white","z-50","w-full","box-border","bg-content1","outline-none","mx-1","my-1","sm:mx-6","sm:my-16"],backdrop:"z-50",header:"flex py-4 px-6 flex-initial text-large font-semibold",body:"flex flex-1 flex-col gap-3 px-6 py-2",footer:"flex flex-row gap-2 px-6 py-4 justify-end",closeButton:["absolute","appearance-none","outline-none","select-none","top-1","right-1","p-2","text-foreground-500","rounded-full","hover:bg-default-100","active:bg-default-200","tap-highlight-transparent",...xe]},variants:{size:{xs:{base:"max-w-xs"},sm:{base:"max-w-sm"},md:{base:"max-w-md"},lg:{base:"max-w-lg"},xl:{base:"max-w-xl"},"2xl":{base:"max-w-2xl"},"3xl":{base:"max-w-3xl"},"4xl":{base:"max-w-4xl"},"5xl":{base:"max-w-5xl"},full:{base:"my-0 mx-0 sm:mx-0 sm:my-0 max-w-full h-[100dvh] !rounded-none"}},radius:{none:{base:"rounded-none"},sm:{base:"rounded-small"},md:{base:"rounded-medium"},lg:{base:"rounded-large"}},placement:{auto:{wrapper:"items-end sm:items-center"},center:{wrapper:"items-center sm:items-center"},top:{wrapper:"items-start sm:items-start"},"top-center":{wrapper:"items-start sm:items-center"},bottom:{wrapper:"items-end sm:items-end"},"bottom-center":{wrapper:"items-end sm:items-center"}},shadow:{sm:{base:"shadow-small"},md:{base:"shadow-medium"},lg:{base:"shadow-large"}},backdrop:{transparent:{backdrop:"hidden"},opaque:{backdrop:"bg-overlay/50 backdrop-opacity-disabled"},blur:{backdrop:"backdrop-blur-md backdrop-saturate-150 bg-overlay/30"}},scrollBehavior:{normal:{base:"overflow-y-hidden"},inside:{base:"max-h-[calc(100%_-_7.5rem)]",body:"overflow-y-auto"},outside:{wrapper:"items-start sm:items-start overflow-y-auto",base:"my-16"}}},defaultVariants:{size:"md",radius:"lg",shadow:"sm",placement:"auto",backdrop:"opaque",scrollBehavior:"normal"},compoundVariants:[{backdrop:["opaque","blur"],class:{backdrop:"w-screen h-screen fixed inset-0"}}]}),_e=r=>e.jsx("svg",{"aria-hidden":"true",fill:"none",focusable:"false",height:"1em",role:"presentation",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,viewBox:"0 0 24 24",width:"1em",...r,children:e.jsx("path",{d:"M18 6L6 18M6 6l12 12"})}),[De,I]=he({name:"ModalContext",errorMessage:"useModalContext: `context` is undefined. Seems you forgot to wrap all popover components within `<Modal />`"}),W=T((r,i)=>{const{as:s,children:d,className:n,...c}=r,{slots:p,classNames:o,bodyId:u,setBodyMounted:a}=I(),t=B(i),m=s||"div";return l.useEffect(()=>(a(!0),()=>a(!1)),[a]),e.jsx(m,{ref:t,className:p.body({class:N(o==null?void 0:o.body,n)}),id:u,...c,children:d})});W.displayName="NextUI.ModalBody";var Re=W,Ae={enter:{scale:"var(--scale-enter)",y:"var(--slide-enter))",opacity:1,transition:{scale:{duration:.4,ease:A.ease},opacity:{duration:.4,ease:A.ease},y:{type:"spring",bounce:0,duration:.6}}},exit:{scale:"var(--scale-exit)",y:"var(--slide-exit)",opacity:0,transition:{duration:.3,ease:A.ease}}},X=T((r,i)=>{const{as:s,children:d,role:n="dialog",...c}=r,{Component:p,domRef:o,slots:u,isOpen:a,classNames:t,motionProps:m,backdrop:f,closeButton:C,hideCloseButton:b,disableAnimation:v,shouldBlockScroll:O,getDialogProps:S,getBackdropProps:g,getCloseButtonProps:y,onClose:j}=I(),Z=s||p||"div",{dialogProps:w}=Ie({role:n},o),_=l.isValidElement(C)?l.cloneElement(C,y()):e.jsx("button",{...y(),children:e.jsx(_e,{})}),k=e.jsxs(Z,{...S(M(w,c)),children:[e.jsx(V,{onDismiss:j}),!b&&_,typeof d=="function"?d(j):d,e.jsx(V,{onDismiss:j})]}),D=l.useMemo(()=>f==="transparent"?null:v?e.jsx("div",{...g()}):e.jsx(L.div,{animate:"enter",exit:"exit",initial:"exit",variants:Me.fade,...g()}),[f,v,g]);return e.jsxs("div",{tabIndex:-1,children:[D,e.jsx(Oe,{forwardProps:!0,enabled:O&&a,removeScrollBar:!1,children:v?e.jsx("div",{className:u.wrapper({class:t==null?void 0:t.wrapper}),children:k}):e.jsx(L.div,{animate:"enter",className:u.wrapper({class:t==null?void 0:t.wrapper}),exit:"exit",initial:"exit",variants:Ae,...m,children:k})})]})});X.displayName="NextUI.ModalContent";var Ue=X,Y=T((r,i)=>{const{as:s,children:d,className:n,...c}=r,{slots:p,classNames:o}=I(),u=B(i),a=s||"footer";return e.jsx(a,{ref:u,className:p.footer({class:N(o==null?void 0:o.footer,n)}),...c,children:d})});Y.displayName="NextUI.ModalFooter";var Ee=Y,ee=T((r,i)=>{const{as:s,children:d,className:n,...c}=r,{slots:p,classNames:o,headerId:u,setHeaderMounted:a}=I(),t=B(i),m=s||"header";return l.useEffect(()=>(a(!0),()=>a(!1)),[a]),e.jsx(m,{ref:t,className:p.header({class:N(o==null?void 0:o.header,n)}),id:u,...c,children:d})});ee.displayName="NextUI.ModalHeader";var ze=ee;function Fe(r={},i,s){let{overlayProps:d,underlayProps:n}=be({...r,isOpen:i.isOpen,onClose:i.close},s);return ve(),l.useEffect(()=>{if(i.isOpen&&s.current)return ge([s.current])},[i.isOpen,s]),{modalProps:M(d),underlayProps:n}}function Ve(r){var i;const[s,d]=ye(r,Q.variantKeys),{ref:n,as:c,className:p,classNames:o,disableAnimation:u=!1,isOpen:a,defaultOpen:t,onOpenChange:m,motionProps:f,closeButton:C,isDismissable:b=!0,hideCloseButton:v=!1,shouldBlockScroll:O=!0,portalContainer:S,isKeyboardDismissDisabled:g=!1,onClose:y,...j}=s,Z=c||"section",w=B(n),_=l.useRef(null),[k,D]=l.useState(!1),[ae,te]=l.useState(!1),oe=l.useId(),E=l.useId(),z=l.useId(),h=Be({isOpen:a,defaultOpen:t,onOpenChange:x=>{m==null||m(x),x||y==null||y()}}),{modalProps:re,underlayProps:F}=Fe({isDismissable:b,isKeyboardDismissDisabled:g},h,w),{buttonProps:ne}=je({onPress:h.close},_),{isFocusVisible:le,focusProps:ie}=we(),de=N(o==null?void 0:o.base,p),q=l.useMemo(()=>Q({...d}),[...Object.values(d)]),ce=(x={},pe=null)=>({ref:qe(pe,w),...M(re,j,x),className:q.base({class:N(de,x.className)}),id:oe,"data-open":P(h.isOpen),"data-dismissable":P(b),"aria-modal":P(!0),"aria-labelledby":k?E:void 0,"aria-describedby":ae?z:void 0}),me=l.useCallback((x={})=>({className:q.backdrop({class:o==null?void 0:o.backdrop}),onClick:()=>h.close(),...F,...x}),[q,o,F]),ue=()=>({role:"button",tabIndex:0,"aria-label":"Close","data-focus-visible":P(le),className:q.closeButton({class:o==null?void 0:o.closeButton}),...M(ne,ie)});return{Component:Z,slots:q,domRef:w,headerId:E,bodyId:z,motionProps:f,classNames:o,isDismissable:b,closeButton:C,hideCloseButton:v,portalContainer:S,shouldBlockScroll:O,backdrop:(i=r.backdrop)!=null?i:"opaque",isOpen:h.isOpen,onClose:h.close,disableAnimation:u,setBodyMounted:te,setHeaderMounted:D,getDialogProps:ce,getBackdropProps:me,getCloseButtonProps:ue}}var se=T((r,i)=>{const{children:s,...d}=r,n=Ve({...d,ref:i}),c=e.jsx(Te,{portalContainer:n.portalContainer,children:s});return e.jsx(De,{value:n,children:n.disableAnimation&&n.isOpen?c:e.jsx(Ne,{children:n.isOpen?c:null})})});se.displayName="NextUI.Modal";var Le=se;const He=r=>e.jsx("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 -960 960 960",width:"1em",className:"inline-block overflow-visible align-text-bottom fill-current",...r,children:e.jsx("path",{d:"M480-480q33 0 56.5-23.5T560-560q0-33-23.5-56.5T480-640q-33 0-56.5 23.5T400-560q0 33 23.5 56.5T480-480Zm0 294q122-112 181-203.5T720-552q0-109-69.5-178.5T480-800q-101 0-170.5 69.5T240-552q0 71 59 162.5T480-186Zm0 106Q319-217 239.5-334.5T160-552q0-150 96.5-239T480-880q127 0 223.5 89T800-552q0 100-79.5 217.5T480-80Zm0-480Z"})}),Ke=r=>e.jsx("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 -960 960 960",width:"1em",className:"inline-block overflow-visible align-text-bottom fill-current",...r,children:e.jsx("path",{d:"m80-80 200-560 360 360L80-80Zm132-132 282-100-182-182-100 282Zm370-246-42-42 224-224q32-32 77-32t77 32l24 24-42 42-24-24q-14-14-35-14t-35 14L582-458ZM422-618l-42-42 24-24q14-14 14-34t-14-34l-26-26 42-42 26 26q32 32 32 76t-32 76l-24 24Zm80 80-42-42 144-144q14-14 14-35t-14-35l-64-64 42-42 64 64q32 32 32 77t-32 77L502-538Zm160 160-42-42 64-64q32-32 77-32t77 32l64 64-42 42-64-64q-14-14-35-14t-35 14l-64 64ZM212-212Z"})}),Qe=r=>e.jsx("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 -960 960 960",width:"1em",className:"inline-block overflow-visible align-text-bottom fill-current",...r,children:e.jsx("path",{d:"M200-80q-33 0-56.5-23.5T120-160v-560q0-33 23.5-56.5T200-800h40v-80h80v80h320v-80h80v80h40q33 0 56.5 23.5T840-720v560q0 33-23.5 56.5T760-80H200Zm0-80h560v-400H200v400Zm0-480h560v-80H200v80Zm0 0v-80 80Zm280 240q-17 0-28.5-11.5T440-440q0-17 11.5-28.5T480-480q17 0 28.5 11.5T520-440q0 17-11.5 28.5T480-400Zm-160 0q-17 0-28.5-11.5T280-440q0-17 11.5-28.5T320-480q17 0 28.5 11.5T360-440q0 17-11.5 28.5T320-400Zm320 0q-17 0-28.5-11.5T600-440q0-17 11.5-28.5T640-480q17 0 28.5 11.5T680-440q0 17-11.5 28.5T640-400ZM480-240q-17 0-28.5-11.5T440-280q0-17 11.5-28.5T480-320q17 0 28.5 11.5T520-280q0 17-11.5 28.5T480-240Zm-160 0q-17 0-28.5-11.5T280-280q0-17 11.5-28.5T320-320q17 0 28.5 11.5T360-280q0 17-11.5 28.5T320-240Zm320 0q-17 0-28.5-11.5T600-280q0-17 11.5-28.5T640-320q17 0 28.5 11.5T680-280q0 17-11.5 28.5T640-240Z"})}),Ge=r=>{try{return BigInt(r)}catch{return}},Je=({isOpen:r,onOpenChange:i,username:s,onUsernameChange:d})=>{const[n,c]=l.useState(s),[p,o]=l.useState(!1),[u]=$e(n,1e3),{show:a}=G();return l.useEffect(()=>{if(u&&u!==s){if(!$(u)){o(!1);return}J({username:u,checkOnly:!0}).then(t=>{var m,f;if(!((m=t.data)!=null&&m.status)){o(!1),t.statusCode===200?a({message:"username already used"}):a({message:(f=t.data)==null?void 0:f.msg});return}o(!0)}).catch(t=>{a({message:t})})}else o(!1)},[u]),l.useEffect(()=>{c(s)},[s]),e.jsx(Le,{isOpen:r,onOpenChange:t=>{c(s),i(t)},children:e.jsx(Ue,{children:t=>e.jsxs(e.Fragment,{children:[e.jsx(ze,{className:"flex flex-col gap-1",children:"Change your username"}),e.jsx(Re,{children:e.jsx(Ze,{className:"font-medium",placeholder:"iTrans unique username",startContent:e.jsx("p",{className:"font-bold",children:"@"}),value:n,onValueChange:m=>{c(m)},errorMessage:$(n)?"":"invalid username"})}),e.jsxs(Ee,{children:[e.jsx(U,{color:"danger",variant:"light",onPress:t,children:"Cancel"}),e.jsx(U,{color:"primary",isDisabled:!p||n===s||!$(n),onPress:()=>{d(n),t()},children:"Submit"})]})]})})})},ls=()=>{const[r,i]=l.useState({type:"self"}),[s,d]=l.useState({firstname:"",lastname:"System",createdAt:new Date}),[n,c]=l.useState({isOpen:!1,username:""}),{profile:p}=Ce(),{show:o}=G(),u=ke();return l.useEffect(()=>{const a=u.id;if(!a)return;if($(a)){i({type:"username",username:a});return}const t=Ge(a);if(t){i({type:"userID",userID:t});return}},[]),l.useEffect(()=>{switch(r.type){case"username":J({username:r.username}).then(a=>{var t,m,f;if(!((t=a.data)!=null&&t.data)||!((m=a.data)!=null&&m.status)){o({message:(f=a.data)==null?void 0:f.msg});return}d({...a.data.data})}).catch(a=>{o({message:a})});break;case"userID":o({message:"unsupported query method"});break;case"self":if(!p){o({message:"failed to get user profile"});return}d({...p});break}},[r]),e.jsxs("div",{children:[e.jsx(Je,{isOpen:n.isOpen,onOpenChange:a=>{c({...n,isOpen:a})},username:s.username,onUsernameChange:a=>{c({...n,username:a}),a&&Pe({username:a}).then(t=>{var m,f;if(!((m=t.data)!=null&&m.status)){o({message:(f=t.data)==null?void 0:f.msg});return}d({...s,username:a})}).catch(t=>{o({message:t})})}}),e.jsx("div",{style:{backgroundSize:"cover",backgroundImage:`url('${s.background?s.background:"/default-background.png"}')`,backgroundPosition:"center",backgroundRepeat:"no-repeat",height:"200px"},children:e.jsx(Se,{style:{position:"relative",zIndex:10,top:"100%",left:"5%",transform:"translate(-5%, -50%)",width:"20vh",height:"auto",userSelect:"none"},alt:s.firstname,src:s.avatar})}),e.jsx(U,{style:{position:"relative",zIndex:10,top:"100%",left:"95%",transform:"translate(-95%, 50%)"},color:"primary",variant:"bordered",radius:"lg",children:"Edit your profile"}),e.jsx("div",{className:"flex items-center mt-16 dark:bg-black",style:{marginTop:"10vh",width:"90%",transform:"translate(5%, 0%)"},children:e.jsxs("div",{children:[e.jsxs("p",{className:"text-4xl font-bold",children:[s.firstname," ",s.lastname,e.jsxs("span",{className:`${s.username?"":"hidden"} ml-3 font-normal text-small text-gray-500 dark:text-gray-400 hover:underline`,onClick:()=>c({...n,isOpen:!0}),children:["@",s.username]})]}),e.jsxs("p",{className:`${s.bio?"":"hidden"} font-medium`,children:["Bio:",e.jsx("span",{className:"ml-1 font-normal text-gray-600 dark:text-gray-300",children:s.bio})]}),e.jsxs("div",{className:"mt-5 whitespace-pre-wrap inline",children:[e.jsxs(R,{variant:"bordered",className:`${s.location?"mr-2":"hidden"}`,children:[e.jsx(He,{width:"1rem",height:"1rem"}),e.jsx("span",{className:"ml-1",children:s.location})]}),e.jsxs(R,{variant:"bordered",className:`${s.birthday?"mt-1 mr-2":"hidden"}`,children:[e.jsx(Ke,{width:"1rem",height:"1rem"}),e.jsxs("span",{className:"ml-1",children:["Born ",H(s.birthday,K("universal"))]})]}),e.jsxs(R,{variant:"bordered",className:"mt-1",children:[e.jsx(Qe,{width:"1rem",height:"1rem"}),e.jsxs("span",{className:"ml-1",children:["Joined ",H(s.createdAt,K("joinDay"))]})]})]})]})})]})};export{ls as default};
