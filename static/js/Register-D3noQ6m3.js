import{r as h,n as e,C as N,M as J,B as K,N as X,O as q,bX as V,z as r,b_ as Q,bZ as Y}from"./index-De6UHybJ.js";import{L as F,F as ee}from"./index-COx8hFg0.js";import{T as se,P as R,c as te,g as ae}from"./oauth2-FEa8GFhJ.js";import{R as ie}from"./index-DgXPivxi.js";import{A as D}from"./index-By70MgDv.js";import{T as re}from"./Trans-ewnF7Amg.js";import{l as M}from"./chunk-4HJHOVVR-CPA5CV6p.js";import{c as I}from"./chunk-H4VOEXHF-Bl4Z9GjO.js";import{i as U}from"./chunk-UWUNWEEL-DoGSzmL5.js";import{c as z}from"./chunk-JHUBASYZ-Dd3lEV97.js";import{i as $}from"./chunk-NNXNFLWG-BRTx-G8Y.js";import{s as j}from"./chunk-IXXDDLGU-5W6ITjT_.js";import{s as le,l as T}from"./chunk-SWJHOPKY-ys4Gdmvi.js";import"./index-C87vmkeI.js";import"./chunk-OZXMJY32-CIFgHRIS.js";import"./chunk-CIZQCQPA-D8BzUrpe.js";import"./import-Cqc15upG.js";import"./text-B64jcAFk.js";import"./context-CFO7G7_-.js";import"./import-DG5TyszC.js";import"./scrollIntoView-w65nIFVW.js";import"./useSelectableItem-Fn5p8js_.js";import"./useCollator-B035wMr7.js";import"./chunk-44JHHBS2-Cy-23fTN.js";const ne=t=>{const{children:s=[],showProgressBar:i=!0,defaultActiveStep:v=1,prevText:P,continueText:S,submitText:n,onContinue:p=()=>{},onPrev:a=()=>{},onSubmit:f=()=>{},disableContinue:_=!1,disableSubmit:L=!1,btnPos:o="space-between",barWidth:g="",strokeColor:x="#cdd3d8",fillStroke:k="#3a4047",stroke:y=2,activeColor:m="#3A4047",activeProgressBorder:A="2px solid #f3f4f5",progressBarClassName:B="",contentBoxClassName:W="",allowClickControl:Z=!0}=t,[d,w]=h.useState(0);h.useEffect(()=>{v<=s.length&&v>0?(C(v-1),w(v)):(C(0),w(1))},[]),h.useEffect(()=>{s.length>1&&i&&s.map((l,u)=>{const c=document.getElementById(`input_${u}`);c.classList.length>1?(c.style.background=m,c.style.border=A):(c.style.background="#fff",c.style.border="2px solid #3A4047")})},[d]);const H=()=>{if(!d||d<=1)return;C(d-2);const l=d-1;w(l),a(l)},O=()=>{if(!d||d>=s.length)return;C(d);const l=d+1;w(l),p(l)},G=l=>{Z&&(w(l+1),C(l))},C=l=>{var u;if(s.length>1&&i){const c=l/(s.length-1)*100;document.getElementsByClassName("percent")[0].style.width=`${c}%`}if(s.length>1&&i)for(let c=0;c<s.length;c++){const b=document.getElementById(`input_${c}`),E=parseInt((u=b==null?void 0:b.id)==null?void 0:u.split("_")[1]);E===l&&(b.classList.add("selected"),b.classList.remove("completed")),E<=l&&b.classList.add("completed"),E>l&&b.classList.remove("selected","completed")}};return e.jsxs("div",{className:"stepperDiv",children:[s.length>1&&i&&e.jsx("div",{className:`progressBarDiv ${B}`,children:e.jsxs("div",{className:"progressBarContainer",style:{width:g},children:[e.jsx("div",{className:"progress",style:{borderBottom:`${y}px solid ${x}`},children:e.jsx("div",{className:"percent",style:{borderBottom:`${y}px solid ${k}`}})}),e.jsx("div",{className:"steps",children:s.map((l,u)=>e.jsx("div",{className:"step",id:`input_${u}`,onClick:()=>G(u)},u))})]})}),e.jsxs("div",{className:W,children:[s.length>1?s.map((l,u)=>d===u+1&&l):s,e.jsxs("div",{style:{display:"flex",justifyContent:o,marginTop:"20px"},children:[d>1?e.jsx(N,{className:"font-medium",color:"default",onPress:H,children:P||"Prev"}):e.jsx("span",{}),d<s.length?e.jsx(N,{className:"font-medium",color:"primary",onPress:()=>O(),isDisabled:_,children:S||"Next"}):e.jsx(N,{className:"font-medium",color:"primary",onPress:()=>f(d),isDisabled:L,children:n||"Submit"})]})]})]})},oe=({form:t,setForm:s})=>e.jsxs("div",{children:[e.jsx("div",{children:e.jsx($,{isClearable:!0,className:"font-medium",type:"text",labelPlacement:"outside",label:r("pages.sign_up.step1.input1"),variant:"bordered",placeholder:" ",value:t.firstname,onValueChange:i=>s({...t,firstname:i})})}),e.jsx(j,{y:4}),e.jsx("div",{children:e.jsx($,{isClearable:!0,className:"font-medium",type:"text",labelPlacement:"outside",label:r("pages.sign_up.step1.input2"),variant:"bordered",placeholder:" ",value:t.lastname,onValueChange:i=>s({...t,lastname:i})})}),e.jsx(j,{y:4}),e.jsxs(le,{className:"font-medium",label:r("pages.sign_up.step1.input3"),labelPlacement:"outside",variant:"bordered",placeholder:r("pages.sign_up.step1.input3_placeholder"),onSelectionChange:i=>s({...t,irrigationDitch:i.values().next().value}),children:[e.jsx(T,{children:r("pages.sign_up.step1.options.key1")},"friend-recommend"),e.jsx(T,{children:r("pages.sign_up.step1.options.key2")},"search-engine"),e.jsx(T,{children:r("pages.sign_up.step1.options.key3")},"third-party-website-recommend"),e.jsx(T,{children:r("pages.sign_up.step1.options.key4")},"other")]})]}),de=({form:t,setForm:s})=>e.jsxs("div",{children:[e.jsx("div",{children:e.jsx($,{isClearable:!0,className:"font-medium",type:"email",labelPlacement:"outside",label:r("pages.sign_up.step2.input1"),variant:"bordered",placeholder:" ",isInvalid:!V(t.email),errorMessage:V(t.email)?"":"invalid email address",value:t.email,onValueChange:i=>s({...t,email:i})})}),e.jsx(j,{y:4}),e.jsx("div",{children:e.jsx($,{isClearable:!0,className:"font-medium",type:"text",labelPlacement:"outside",label:r("pages.sign_up.step2.input2"),variant:"bordered",placeholder:" ",value:t.inviteCode,onValueChange:i=>s({...t,inviteCode:i})})})]}),ce=({form:t,setForm:s})=>e.jsxs("div",{children:[e.jsx("div",{children:e.jsx(R,{className:"font-medium",labelPlacement:"outside",label:r("pages.sign_up.step3.input1"),variant:"bordered",placeholder:" ",value:t.password,onValueChange:i=>s({...t,password:i})})}),e.jsx(j,{y:4}),e.jsx("div",{children:e.jsx(R,{className:"font-medium",labelPlacement:"outside",label:r("pages.sign_up.step3.input2"),variant:"bordered",placeholder:" ",value:t.repeatPassword,onValueChange:i=>s({...t,repeatPassword:i}),errorMessage:t.password!==t.repeatPassword?"invalid repeat password":""})}),e.jsx(j,{y:4}),e.jsx("div",{className:"w-full flex justify-center",children:e.jsx(ie,{onValueChange:i=>{s({...t,recaptcha:i})}})}),e.jsx(j,{y:4}),e.jsx("div",{className:"flex items-start",children:e.jsx(te,{onValueChange:i=>s({...t,acceptTerm:i}),children:e.jsx(re,{i18nKey:"pages.sign_up.step3.terms",components:{Link:e.jsx(M,{href:"/docs/t?part=term"})}})})})]}),Ve=()=>{const t=J(),s=K(),{authed:i,update:v}=X(),[P,S]=h.useState(!0),[n,p]=h.useState({step:1,disabled:!1}),[a,f]=h.useState({recaptcha:null,acceptTerm:!1,email:"",firstname:"",irrigationDitch:"",lastname:"",password:"",repeatPassword:""}),{show:_}=q(),L=()=>{p({...n,disabled:!0}),Q({email:a.email,password:a.password,firstname:a.firstname,lastname:a.lastname,ticket:a.recaptcha,inviteCode:a.inviteCode,payload:a.authCallback}).then(o=>{var g,x,k,y;if(!((g=o.data)!=null&&g.status)){f({...a,recaptcha:null}),_({message:(x=o.data)==null?void 0:x.msg});return}v({ticket:(k=o.data.data)==null?void 0:k.ticket,expire:(y=o.data.data)==null?void 0:y.expire}),Y().then(m=>{var A,B;!((A=m.data)!=null&&A.data)||!((B=m.data)!=null&&B.status)||s.set({...m.data.data.profile,recentActivity:m.data.data.recentActivity,emailVerified:m.data.data.emailVerified})}).catch(m=>{_({message:m.toString()})}).finally(()=>t("/"))}).catch(o=>{_({message:o})}).finally(()=>{p({...n,disabled:!1})})};return h.useEffect(()=>{switch(p({...n,disabled:!0}),n.step){case 1:p({...n,disabled:!a.firstname||!a.lastname||!a.irrigationDitch});break;case 2:p({...n,disabled:!a.email||!V(a.email)});break;case 3:p({...n,disabled:!a.recaptcha||!a.password||a.password!==a.repeatPassword||!a.acceptTerm});break}},[a,n.step]),h.useEffect(()=>{if(i()){t("/");return}const o=window.location.hash;if(!o)return;const g=new URLSearchParams(o.substring(1)).get("tgAuthResult");if(!g)return;const x=JSON.parse(atob(g));f({...a,firstname:x.first_name,lastname:x.last_name,authCallback:g}),S(!1)},[]),e.jsxs("div",{className:"flex flex-col items-center justify-center px-6 py-8 mx-auto h-screen lg:py-0",children:[e.jsx(M,{href:"/",children:e.jsx(F,{className:"select-none",width:200,loading:"lazy"})}),e.jsxs("div",{className:`${P?"":"hidden"} mt-10 flex flex-row justify-between space-x-4 text-medium`,children:[e.jsxs(I,{isFooterBlurred:!0,radius:"lg",className:"border-none",children:[e.jsx(U,{alt:r("pages.sign_up.import_from_telegram"),className:"object-cover",height:200,src:D({src:"/images/gifs/signup_new_account.gif",custom:!0}),width:200,radius:"lg",isZoomed:!0}),e.jsx(z,{className:"p-0 justify-center overflow-hidden absolute before:rounded-xl rounded-large bottom-1 w-[calc(100%_-_8px)] shadow-small ml-1 z-10",children:e.jsx(N,{variant:"solid",color:"primary",radius:"lg",fullWidth:!0,onClick:()=>S(!1),children:r("pages.sign_up.new_account")})})]}),e.jsxs(I,{isFooterBlurred:!0,radius:"lg",className:"border-none",children:[e.jsx(U,{alt:r("pages.sign_up.import_from_telegram"),className:"object-cover",height:200,src:D({src:"/images/gifs/signup_import_from_telegram.gif",custom:!0}),width:200,radius:"lg",isZoomed:!0}),e.jsx(z,{className:"p-0 justify-center overflow-hidden absolute before:rounded-xl rounded-large bottom-1 w-[calc(100%_-_8px)] shadow-small ml-1 z-10",children:e.jsx(N,{variant:"solid",color:"primary",radius:"lg",fullWidth:!0,onClick:()=>{window.location.href=se({botID:"7068700945",origin:ae(),redirectURI:"https://itrans.app/signup"})},children:r("pages.sign_up.import_from_telegram")})})]})]}),e.jsx("div",{className:`w-full mt-6 sm:max-w-md xl:p-5 p-2 ${P?"hidden":""}`,children:e.jsxs(ne,{defaultActiveStep:n.step,showProgressBar:!1,prevText:r("step_prev"),continueText:r("step_next"),submitText:r("pages.sign_up.sign_up"),disableContinue:n.disabled,disableSubmit:n.disabled,onContinue:o=>p({...n,step:o}),onPrev:o=>p({...n,step:o}),onSubmit:L,children:[e.jsx(oe,{form:a,setForm:f}),e.jsx(de,{form:a,setForm:f}),e.jsx(ce,{form:a,setForm:f})]})}),e.jsx(ee.Login,{})]})};export{Ve as default};
