import{l as e,P as w,L as N,r as c,Q as k,z as u}from"./index-C-Prt1zy.js";import{O as y,m as _}from"./Open-Bp5o6qZH.js";import{a as x,A as $}from"./Avatar-BOOSPuXc.js";import{L as A,C}from"./ColorDot-vk9PtYQE.js";import{l as h}from"./chunk-MPX6TMFQ-BiFTckR-.js";import{o as Z}from"./index.module-BqSyIiB_.js";import{d as p,b,c as g,m as j}from"./chunk-L6QJ42W6-rhU2cYIl.js";import{i as F}from"./chunk-TC4QW7OA-CoWQUZMs.js";import"./import-DmZ4oXrM.js";import"./index-BdgdgevS.js";import"./index-BkHgiBvb.js";import"./chunk-OFH6WYRQ-BFMlG2hP.js";import"./chunk-LY2CD73K-Cqrt4fqR.js";import"./chunk-CAFRINWI-CcU5yOMx.js";import"./Combination-BoDDcLfA.js";import"./chunk-44JHHBS2-CofP4Tlp.js";const L=s=>e.jsxs("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 0 24 24",width:"1em",color:"#a371f7",className:"inline-block overflow-visible align-text-bottom fill-current",...s,children:[e.jsx("path",{d:"M11.28 6.78a.75.75 0 0 0-1.06-1.06L7.25 8.69 5.78 7.22a.75.75 0 0 0-1.06 1.06l2 2a.75.75 0 0 0 1.06 0l3.5-3.5Z"}),e.jsx("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0Zm-1.5 0a6.5 6.5 0 1 0-13 0 6.5 6.5 0 0 0 13 0Z"})]}),S=s=>e.jsx("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 -960 960 960",width:"1em",className:"inline-block overflow-visible align-text-bottom fill-current",...s,children:e.jsx("path",{d:"M240-400h480v-80H240v80Zm0-120h480v-80H240v80Zm0-120h480v-80H240v80ZM880-80 720-240H160q-33 0-56.5-23.5T80-320v-480q0-33 23.5-56.5T160-880h640q33 0 56.5 23.5T880-800v720ZM160-320h594l46 45v-525H160v480Zm0 0v-480 480Z"})}),T=({entry:s})=>e.jsxs("div",{className:"flex flex-auto items-center hover:bg-gray-100 dark:hover:bg-gray-800 rounded-none sm:rounded-lg",children:[e.jsx("div",{className:"flex-shrink-0 pt-2 pl-3",children:s.close?e.jsx(L,{height:"2em",width:"2em"}):e.jsx(y,{height:"2em",width:"2em"})}),e.jsxs("div",{className:"min-w-0 p-2 pr-3 md:pr-2",children:[e.jsx(h,{className:"text-large font-medium",color:"foreground",underline:"hover",style:{userSelect:"text"},href:`/chalkboard/${s.id.toString()}`,children:s.title}),e.jsx("div",{className:"ml-2 inline",children:s.labels?e.jsx(A,{size:"sm",labels:s.labels}):e.jsx(e.Fragment,{})}),e.jsxs("div",{className:"text-gray-400",style:{fontSize:"13px"},children:[`#${s.id.toString(16).slice(0,8)} `,s.close?e.jsxs(e.Fragment,{children:[e.jsx(h,{size:"sm",href:`/user/${s.username}`,children:`@${s.username}`}),e.jsx("p",{className:"inline ml-1",children:`was closed ${x(s.updatedAt)} ago`})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"inline",children:`opened ${x(s.createdAt)} ago by`}),e.jsx(h,{className:"ml-1",size:"sm",href:`/user/${s.username}`,children:`@${s.username}`})]})]})]}),e.jsxs("div",{className:"hidden sm:flex ml-auto flex-shrink-0 items-center justify-between text-right pr-3 whitespace-nowrap ",children:[e.jsx("span",{className:"ml-2 flex-1 flex-shrink-0",children:e.jsx($,{alt:s.username,size:"sm",src:`@${s.username}`})}),e.jsxs("span",{className:"ml-6 flex-1 flex-shrink-0 items-center content-center text-gray-700 dark:text-gray-300",children:[e.jsx(S,{width:"1rem",height:"1rem",className:"inline-flex overflow-visible fill-current"}),e.jsx("span",{className:"ml-1 text-small font-bold",children:s.comments})]})]})]}),E=({entries:s})=>e.jsx("div",{className:"w-full divide-y divide-gray-200 dark:divide-gray-700",children:s.map((a,t)=>e.jsx(T,{entry:a},t))}),z=s=>e.jsx("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 -960 960 960",width:"1em",className:"inline-block overflow-visible align-text-bottom fill-current",...s,children:e.jsx("path",{d:"M480-360 280-560h400L480-360Z"})}),f={is:{open:()=>({open:!0})},author:{"@me":()=>({author:"self"}),"*":s=>s.charAt(0)==="@"?{author:s.slice(1,s.length)}:{author:s}},mentions:{"@me":()=>({mentions:"self"}),"*":s=>s.charAt(0)==="@"?{mentions:s.slice(1,s.length)}:{mentions:s}},label:{"*":s=>({label:[s.slice(1,s.length-1)]})}},M=s=>{const a={};return s.split(" ").reduce((t,i)=>{const[n,o]=i.split(":");if(n&&o){const l=n.trim(),m=o.trim();t[l]||(t[l]=new Set),t[l].has(l)||t[l].add(m)}return t},a),Object.fromEntries(Object.entries(a).map(([t,i])=>[t,[...i]]))},O=s=>{const a=[],t=M(s);for(const[i,n]of Object.entries(t))f[i]&&n.forEach(o=>{(f[i][o]||f[i]["*"])&&a.push(`${i}:${o}`)});return a.join(" ")},H=[{name:"Open chalkboards",rules:"is:open"},{name:"Your chalkboards",rules:"is:open author:@me"},{name:"Everything mentioning you",rules:"is:open mentions:@me"}],se=()=>{const{labels:s}=w(),{show:a}=N(),[t,i]=c.useState({total:0,offset:0,limit:10}),[n,o]=c.useState(void 0),[l,m]=c.useState("is:open"),[v]=Z(l,1e3);return c.useEffect(()=>{l&&m(O(l))},[v]),c.useEffect(()=>{k({offset:t.offset,limit:t.limit,labels:[],sort:1}).then(r=>{var d;if(!r.data){a({message:"Failed to fetch chalkboards"});return}if(!r.data.status||!r.data.data){a({message:(d=r.data)==null?void 0:d.msg});return}i({...t,total:r.data.data.total}),console.log(r.data.data.list),o(r.data.data.list)}).catch(r=>{a({message:r.toString()})})},[t.limit,t.offset]),e.jsxs("div",{className:"sm:pl-2 sm:pr-2",children:[e.jsxs("div",{className:"pb-2 flex gap-2",children:[e.jsx(F,{classNames:{inputWrapper:"pl-0 h-unit-10 rounded-medium rounded-l-none sm:rounded-l-medium"},color:"primary",radius:"md",startContent:e.jsxs(p,{children:[e.jsx(b,{children:e.jsx(u,{endContent:e.jsx(z,{width:"1.25rem",height:"1.25rem"}),size:"md",className:"font-medium",variant:"light",children:"Filter"})}),e.jsx(g,{"aria-label":"chalkboard filter options",children:H.map((r,d)=>e.jsx(j,{onClick:()=>m(r.rules),children:r.name},d))})]}),value:l,onValueChange:m}),e.jsxs(p,{children:[e.jsx(b,{children:e.jsx(u,{className:"hidden md:flex font-medium",variant:"bordered",color:"secondary",children:"Labels"})}),e.jsx(g,{"aria-label":"label filter",selectionMode:"single",onAction:r=>{m(`${l} label:"${s[r].name}"`)},children:e.jsx(_,{title:"Filter by label",children:s.map((r,d)=>e.jsx(j,{textValue:r.name,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(C,{color:r.color,width:"1rem",height:"1rem"}),e.jsx("div",{className:"ml-2 truncate min-w-0 flex items-center",children:e.jsx("div",{className:"font-medium",children:r.name})})]})},d))})})]}),e.jsx(u,{className:"hidden md:flex font-medium",color:"primary",as:h,href:"/chalkboard/new",children:"New Chalkboard"}),e.jsx(u,{className:"flex md:hidden rounded-r-none sm:rounded-r-medium font-medium",color:"primary",as:h,href:"/chalkboard/new",children:"New"})]}),e.jsx("div",{children:n?e.jsx(E,{entries:n}):e.jsx("div",{className:"py-3 flex items-center text-md text-gray-400 uppercase before:flex-1 before:border-t before:border-gray-200 before:me-6 after:flex-1 after:border-t after:border-gray-200 after:ms-6 dark:text-gray-500 dark:before:border-gray-600 dark:after:border-gray-600",children:"Empty"})})]})};export{se as default};
